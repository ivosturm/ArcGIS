//>>built
require({cache:{"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(l,u,n,t,x,g,d,f,b,c){function v(a,c){for(var b=a.length-1;c<b;)a[c]=a[++c];a.length=b}var h=l.shape={};h.Shape=n("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;
if(x("gfxRegistry")){var a=h.register(this);this.getUID=function(){return a}}},destroy:function(){x("gfxRegistry")&&h.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},
getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[c.multiplyPoint(b,a.x,a.y),c.multiplyPoint(b,a.x+a.width,a.y),c.multiplyPoint(b,a.x+a.width,a.y+a.height),c.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=l.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=
null,this;var c=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":c=l.makeParameters(l.defaultLinearGradient,a);break;case "radial":c=l.makeParameters(l.defaultRadialGradient,a);break;case "pattern":c=l.makeParameters(l.defaultPattern,a)}else c=l.normalizeColor(a);this.fillStyle=c;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||u.isArray(a)||a instanceof b)a={color:a};a=this.strokeStyle=l.makeParameters(l.defaultStroke,a);a.color=
l.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=c.clone(a?c.normalize(a):c.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,
a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,c){this.parent=a;return this._updateParentMatrix(c)},_updateParentMatrix:function(a){this.parentMatrix=a?c.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=c.multiply(b.matrix,
a)),b=b.parent;return a}});h._eventsProcessing={on:function(a,c){return g(this.getEventSource(),a,h.fixCallback(this,l.fixTarget,c))},connect:function(a,c,b){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,b?u.hitch(c,b):c)},disconnect:function(a){return a.remove()}};h.fixCallback=function(a,c,b,d){d||(d=b,b=null);if(u.isString(d)){b=b||t.global;if(!b[d])throw['dojox.gfx.shape.fixCallback: scope["',d,'"] is null (scope\x3d"',b,'")'].join("");return function(h){return c(h,a)?b[d].apply(b,
arguments||[]):void 0}}return b?function(h){return c(h,a)?d.apply(b,arguments||[]):void 0}:function(h){return c(h,a)?d.apply(b,arguments):void 0}};u.extend(h.Shape,h._eventsProcessing);h.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var c=a.getParent();c&&c.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,c){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){c||(a.parent=null,a.parentMatrix=null);v(this.children,b);break}return this},clear:function(a){for(var c,b=0;b<this.children.length;++b)c=this.children[b],c.parent=null,c.parentMatrix=null,a&&c.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;d.forEach(this.children,function(b){var d=b.getBoundingBox();d&&((b=b.getTransform())&&(d=c.multiplyRectangle(b,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,
d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){v(this.children,c);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){v(this.children,c);this.children.unshift(a);break}return this}};h.Surface=n("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=
this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){d.forEach(this._nodes,f.destroy);this._nodes=[];d.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(x("ie"))for(;this._parent.lastChild;)f.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,c){var b=u.hitch(a,c);if(this.isLoaded)b(this);
else g.once(this,"load",function(a){b(a)})}});u.extend(h.Surface,h._eventsProcessing);h.Rect=n("dojox.gfx.shape.Rect",h.Shape,{constructor:function(a){this.shape=l.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});h.Ellipse=n("dojox.gfx.shape.Ellipse",h.Shape,{constructor:function(a){this.shape=l.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});
h.Circle=n("dojox.gfx.shape.Circle",h.Shape,{constructor:function(a){this.shape=l.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});h.Line=n("dojox.gfx.shape.Line",h.Shape,{constructor:function(a){this.shape=l.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-
a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});h.Polyline=n("dojox.gfx.shape.Polyline",h.Shape,{constructor:function(a){this.shape=l.getDefault("Polyline");this.rawNode=a},setShape:function(a,c){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),c&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,c=a&&a.length;if(c&&"number"==typeof a[0]){for(var b=[],d=0;d<c;d+=
2)b.push({x:a[d],y:a[d+1]});this.shape.points=b}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,c=a.length,b=a[0],d=b.x,h=b.y,f=b.x,g=b.y,v=1;v<c;++v)b=a[v],d>b.x&&(d=b.x),f<b.x&&(f=b.x),h>b.y&&(h=b.y),g<b.y&&(g=b.y);this.bbox={x:d,y:h,width:f-d,height:g-h}}return this.bbox}});h.Image=n("dojox.gfx.shape.Image",h.Shape,{constructor:function(a){this.shape=l.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},
setFill:function(){return this}});h.Text=n(h.Shape,{constructor:function(a){this.fontStyle=null;this.shape=l.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?l.splitFontString(a):l.makeParameters(l.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=l._base._computeTextBoundingBox(this));return a}});h.Creator={createShape:function(a){switch(a.type){case l.defaultPath.type:return this.createPath(a);
case l.defaultRect.type:return this.createRect(a);case l.defaultCircle.type:return this.createCircle(a);case l.defaultEllipse.type:return this.createEllipse(a);case l.defaultLine.type:return this.createLine(a);case l.defaultPolyline.type:return this.createPolyline(a);case l.defaultImage.type:return this.createImage(a);case l.defaultText.type:return this.createText(a);case l.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(l.Group)},createRect:function(a){return this.createObject(l.Rect,
a)},createEllipse:function(a){return this.createObject(l.Ellipse,a)},createCircle:function(a){return this.createObject(l.Circle,a)},createLine:function(a){return this.createObject(l.Line,a)},createPolyline:function(a){return this.createObject(l.Polyline,a)},createImage:function(a){return this.createObject(l.Image,a)},createText:function(a){return this.createObject(l.Text,a)},createPath:function(a){return this.createObject(l.Path,a)},createTextPath:function(a){return this.createObject(l.TextPath,{}).setText(a)},
createObject:function(a,c){return null}};return h})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(l,u,n,t,x){x=n("dojox.gfx.path.Path",x.Shape,{constructor:function(g){this.shape=u.clone(l.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=g;this.segmented=!1},setAbsoluteMode:function(g){this._confirmSegmented();this.absolute="string"==typeof g?"absolute"==g:g;return this},getAbsoluteMode:function(){this._confirmSegmented();
return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var g=this.bbox,d=this._getRealMatrix();this.bbox=null;for(var f=0,b=this.segments.length;f<b;++f)this._updateWithSegment(this.segments[f],d);d=this.bbox;this.bbox=g;return this.tbbox=d?[{x:d.l,y:d.t},{x:d.r,y:d.t},{x:d.r,
y:d.b},{x:d.l,y:d.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(g,d,f){f&&(d=t.multiplyPoint(f,g,d),g=d.x,d=d.y);this.bbox&&"l"in this.bbox?(this.bbox.l>g&&(this.bbox.l=g),this.bbox.r<g&&(this.bbox.r=g),this.bbox.t>d&&(this.bbox.t=d),this.bbox.b<d&&(this.bbox.b=d)):this.bbox={l:g,b:d,r:g,t:d}},_updateWithSegment:function(g,d){var f=g.args,b=f.length,
c;switch(g.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<b;c+=2)this._updateBBox(f[c],f[c+1],d);this.last.x=f[b-2];this.last.y=f[b-1];this.absolute=!0;break;case "H":for(c=0;c<b;++c)this._updateBBox(f[c],this.last.y,d);this.last.x=f[b-1];this.absolute=!0;break;case "V":for(c=0;c<b;++c)this._updateBBox(this.last.x,f[c],d);this.last.y=f[b-1];this.absolute=!0;break;case "m":c=0;"x"in this.last||(this._updateBBox(this.last.x=f[0],this.last.y=f[1],d),c=2);for(;c<b;c+=2)this._updateBBox(this.last.x+=
f[c],this.last.y+=f[c+1],d);this.absolute=!1;break;case "l":case "t":for(c=0;c<b;c+=2)this._updateBBox(this.last.x+=f[c],this.last.y+=f[c+1],d);this.absolute=!1;break;case "h":for(c=0;c<b;++c)this._updateBBox(this.last.x+=f[c],this.last.y,d);this.absolute=!1;break;case "v":for(c=0;c<b;++c)this._updateBBox(this.last.x,this.last.y+=f[c],d);this.absolute=!1;break;case "c":for(c=0;c<b;c+=6)this._updateBBox(this.last.x+f[c],this.last.y+f[c+1],d),this._updateBBox(this.last.x+f[c+2],this.last.y+f[c+3],d),
this._updateBBox(this.last.x+=f[c+4],this.last.y+=f[c+5],d);this.absolute=!1;break;case "s":case "q":for(c=0;c<b;c+=4)this._updateBBox(this.last.x+f[c],this.last.y+f[c+1],d),this._updateBBox(this.last.x+=f[c+2],this.last.y+=f[c+3],d);this.absolute=!1;break;case "A":for(c=0;c<b;c+=7)this._updateBBox(f[c+5],f[c+6],d);this.last.x=f[b-2];this.last.y=f[b-1];this.absolute=!0;break;case "a":for(c=0;c<b;c+=7)this._updateBBox(this.last.x+=f[c+5],this.last.y+=f[c+6],d);this.absolute=!1}g=[g.action];for(c=0;c<
b;++c)g.push(l.formatNumber(f[c],!0));if("string"==typeof this.shape.path)this.shape.path+=g.join("");else for(c=0,b=g.length;c<b;++c)this.shape.path.push(g[c])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(g,d){this.tbbox=null;var f=this._validSegments[g.toLowerCase()];"number"==typeof f&&(f?d.length>=f&&(g={action:g,args:d.slice(0,d.length-d.length%f)},this.segments.push(g),this._updateWithSegment(g)):(g={action:g,args:[]},this.segments.push(g),this._updateWithSegment(g)))},
_collectArgs:function(g,d){for(var f=0;f<d.length;++f){var b=d[f];"boolean"==typeof b?g.push(b?1:0):"number"==typeof b?g.push(b):b instanceof Array?this._collectArgs(g,b):"x"in b&&"y"in b&&g.push(b.x,b.y)}},moveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"M":"m",g);return this},lineTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"L":"l",g);return this},hLineTo:function(){this._confirmSegmented();
var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"H":"h",g);return this},vLineTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"V":"v",g);return this},curveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"C":"c",g);return this},smoothCurveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"S":
"s",g);return this},qCurveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"Q":"q",g);return this},qSmoothCurveTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"T":"t",g);return this},arcTo:function(){this._confirmSegmented();var g=[];this._collectArgs(g,arguments);this._pushSegment(this.absolute?"A":"a",g);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",
[]);return this},_confirmSegmented:function(){if(!this.segmented){var g=this.shape.path;this.shape.path=[];this._setPath(g);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(g){g=u.isArray(g)?g:g.match(l.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(g){for(var d="",f=[],b=g.length,c=0;c<b;++c){var v=g[c],h=parseFloat(v);isNaN(h)?(d&&this._pushSegment(d,f),f=[],d=v):f.push(h)}this._pushSegment(d,f)}},setShape:function(g){this.inherited(arguments,
["string"==typeof g?{path:g}:g]);this.segmented=!1;this.segments=[];l.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});n=n("dojox.gfx.path.TextPath",x,{constructor:function(g){"text"in this||(this.text=u.clone(l.defaultTextPath));"fontStyle"in this||(this.fontStyle=u.clone(l.defaultFont))},getText:function(){return this.text},setText:function(g){this.text=l.makeParameters(this.text,"string"==typeof g?{text:g}:g);this._setText();return this},getFont:function(){return this.fontStyle},
setFont:function(g){this.fontStyle="string"==typeof g?l.splitFontString(g):l.makeParameters(l.defaultFont,g);this._setFont();return this}});return l.path={Path:x,TextPath:n}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(l,u,n){function t(c){var b=Math.cos(c);c=Math.sin(c);var d={x:b+4/3*(1-b),y:c-4/3*b*(1-b)/c};return{s:{x:b,y:-c},c1:{x:d.x,y:-d.y},c2:d,e:{x:b,y:c}}}var x=2*Math.PI,g=Math.PI/4,d=Math.PI/8,f=g+d,b=t(d);return l.arc={unitArcAsBezier:t,curvePI4:b,
arcAsBezier:function(c,v,h,a,l,A,y,r){l=!!l;A=!!A;var q=n._degToRad(a);a=v*v;var B=h*h,w=n.multiplyPoint(n.rotate(-q),{x:(c.x-y)/2,y:(c.y-r)/2}),u=w.x*w.x,I=w.y*w.y;a=Math.sqrt((a*B-a*I-B*u)/(a*I+B*u));isNaN(a)&&(a=0);a={x:a*v*w.y/h,y:-a*h*w.x/v};l==A&&(a={x:-a.x,y:-a.y});a=n.multiplyPoint([n.translate((c.x+y)/2,(c.y+r)/2),n.rotate(q)],a);v=n.normalize([n.translate(a.x,a.y),n.rotate(q),n.scale(v,h)]);a=n.invert(v);c=n.multiplyPoint(a,c);r=n.multiplyPoint(a,y,r);y=Math.atan2(c.y,c.x);a=y-Math.atan2(r.y,
r.x);A&&(a=-a);0>a?a+=x:a>x&&(a-=x);h=d;r=b;h=A?h:-h;c=[];for(l=a;0<l;l-=g)l<f&&(h=l/2,r=t(h),h=A?h:-h,l=0),w=n.normalize([v,n.rotate(y+h)]),A?(a=n.multiplyPoint(w,r.c1),q=n.multiplyPoint(w,r.c2),w=n.multiplyPoint(w,r.e)):(a=n.multiplyPoint(w,r.c2),q=n.multiplyPoint(w,r.c1),w=n.multiplyPoint(w,r.s)),c.push([a.x,a.y,q.x,q.y,w.x,w.y]),y+=2*h;return c}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(l,u,n){function t(b,c){return Math.abs(b-c)<=1E-6*(Math.abs(b)+
Math.abs(c))}function x(b,c,d,h){if(!isFinite(b))return d;if(!isFinite(d))return b;c=Math.abs(c);h=Math.abs(h);return(c*b+h*d)/(c+h)}function g(b){b=n.normalize(b);var c=-b.xx-b.yy,d=b.xx*b.yy-b.xy*b.yx,h=Math.sqrt(c*c-4*d),c=-(c+(0>c?-h:h))/2,d=d/c,h=b.xy/(c-b.xx),a=1,f=b.xy/(d-b.xx),g=1;t(c,d)&&(h=1,f=a=0,g=1);isFinite(h)||(h=1,a=(c-b.xx)/b.xy,isFinite(a)||(h=(c-b.yy)/b.yx,a=1,isFinite(h)||(h=1,a=b.yx/(c-b.yy))));isFinite(f)||(f=1,g=(d-b.xx)/b.xy,isFinite(g)||(f=(d-b.yy)/b.yx,g=1,isFinite(f)||(f=
1,g=b.yx/(d-b.yy))));b=Math.sqrt(h*h+a*a);var l=Math.sqrt(f*f+g*g);isFinite(h/=b)||(h=0);isFinite(a/=b)||(a=0);isFinite(f/=l)||(f=0);isFinite(g/=l)||(g=0);return{value1:c,value2:d,vector1:{x:h,y:a},vector2:{x:f,y:g}}}function d(b,c){var d=0>b.xx*b.yy||0<b.xy*b.yx?-1:1,f=c.angle1=(Math.atan2(b.yx,b.yy)+Math.atan2(-d*b.xy,d*b.xx))/2,d=Math.cos(f),f=Math.sin(f);c.sx=x(b.xx/d,d,-b.xy/f,f);c.sy=x(b.yy/d,d,b.yx/f,f);return c}function f(b,c){var d=0>b.xx*b.yy||0<b.xy*b.yx?-1:1,f=c.angle2=(Math.atan2(d*b.yx,
d*b.xx)+Math.atan2(-b.xy,b.yy))/2,d=Math.cos(f),f=Math.sin(f);c.sx=x(b.xx/d,d,b.yx/f,f);c.sy=x(b.yy/d,d,-b.xy/f,f);return c}return l.decompose=function(b){var c=n.normalize(b);b={dx:c.dx,dy:c.dy,sx:1,sy:1,angle1:0,angle2:0};if(t(c.xy,0)&&t(c.yx,0))return u.mixin(b,{sx:c.xx,sy:c.yy});if(t(c.xx*c.yx,-c.xy*c.yy))return d(c,b);if(t(c.xx*c.xy,-c.yx*c.yy))return f(c,b);var l,h=new n.Matrix2D(c);l=u.mixin(h,{dx:0,dy:0,xy:h.yx,yx:h.xy});h=g([c,l]);l=g([l,c]);h=new n.Matrix2D({xx:h.vector1.x,xy:h.vector2.x,
yx:h.vector1.y,yy:h.vector2.y});l=new n.Matrix2D({xx:l.vector1.x,xy:l.vector1.y,yx:l.vector2.x,yy:l.vector2.y});c=new n.Matrix2D([n.invert(h),c,n.invert(l)]);d(l,b);c.xx*=b.sx;c.yy*=b.sy;f(h,b);c.xx*=b.sx;c.yy*=b.sy;return u.mixin(b,{sx:c.xx,sy:c.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(l){l=l.bezierutils={};l.tAtLength=function(d,f){var b=0,c=6==d.length,l=0,h=0,a=c?t:g,u=function(g,v){for(var r=0,q=0;q<g.length-2;q+=2)r+=n(g[q],g[q+1],g[q+2],g[q+3]);q=c?n(d[0],d[1],
d[4],d[5]):n(d[0],d[1],d[6],d[7]);r-q>v||l+r>f+v?(++h,g=a(g,.5),u(g[0],v),Math.abs(l-f)<=v||u(g[1],v)):(l+=r,b+=1/(1<<h))};f&&u(d,.5);return b};var u=l.computeLength=function(d){for(var f=6==d.length,b=0,c=0;c<d.length-2;c+=2)b+=n(d[c],d[c+1],d[c+2],d[c+3]);c=f?n(d[0],d[1],d[4],d[5]):n(d[0],d[1],d[6],d[7]);.1<b-c&&(d=f?t(d,.5):x(d,.5),b=u(d[0],f),b+=u(d[1],f));return b},n=l.distance=function(d,f,b,c){return Math.sqrt((b-d)*(b-d)+(c-f)*(c-f))},t=function(d,f){var b=1-f,c=b*b,g=f*f,h=d[0],a=d[1],l=
d[2],n=d[3],t=d[4];d=d[5];var r=c*h+2*b*f*l+g*t,c=c*a+2*b*f*n+g*d;return[[h,a,b*h+f*l,b*a+f*n,r,c],[r,c,b*l+f*t,b*n+f*d,t,d]]},x=function(d,f){var b=1-f,c=b*b,g=c*b,h=f*f,a=h*f,l=d[0],n=d[1],t=d[2],r=d[3],q=d[4],u=d[5],w=d[6];d=d[7];var x=g*l+3*c*f*t+3*b*h*q+a*w,g=g*n+3*c*f*r+3*b*h*u+a*d;return[[l,n,b*l+f*t,b*n+f*r,c*l+2*b*f*t+h*q,c*n+2*b*f*r+h*u,x,g],[x,g,c*t+2*b*f*q+h*w,c*r+2*b*f*u+h*d,b*q+f*w,b*u+f*d,w,d]]},g=l.splitBezierAtT=function(d,f){return 6==d.length?t(d,f):x(d,f)};return l})},"*noref":1}});
define("dojox/gfx/canvas","./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(l,u,n,t,x,g,d,f,b,c,v,h,a){function B(e,k,m,a,c,b,d,f,g,l){var z,h,J=k.length,n=0;l?(h=l.l/c,n=l.i):h=k[0]/c;for(;b<d;)b+h>d&&(z={l:(b+h-d)*c,i:n},h=d-b),n%2||(e.beginPath(),e.arc(m,a,c,b,b+h,f),g&&e.stroke()),b+=h,++n,h=k[n%J]/c;return z}function A(e,k,m,c){var b=0,d=0,z,f=0;c?(z=c.l,f=c.i):
z=k[0];for(;1>d;)d=a.tAtLength(e,z),1==d&&(b=a.computeLength(e),b={l:z-b,i:f}),e=a.splitBezierAtT(e,d),f%2||m.push(e[0]),e=e[1],++f,z=k[f%k.length];return b}function y(e,k,m,a){var c=[k.last.x,k.last.y].concat(m),b=!(e instanceof Array);m=4===m.length?"quadraticCurveTo":"bezierCurveTo";var d=[];k=A(c,k.canvasDash,d,a);for(a=0;a<d.length;++a)c=d[a],b?(e.moveTo(c[0],c[1]),e[m].apply(e,c.slice(2))):(e.push("moveTo",[c[0],c[1]]),e.push(m,c.slice(2)));return k}function r(e,k,m,c,b,d,f){var z=0,g=0,h=0,
l=a.distance(m,c,b,d),n=0;k=k.canvasDash;var J=m,q=c,r,N=!(e instanceof Array);f?(h=f.l,n=f.i):h+=k[0];for(;.01<Math.abs(1-g);)h>l&&(z={l:h-l,i:n},h=l),g=h/l,f=m+(b-m)*g,r=c+(d-c)*g,n++%2||(N?(e.moveTo(J,q),e.lineTo(f,r)):(e.push("moveTo",[J,q]),e.push("lineTo",[f,r]))),J=f,q=r,h+=k[n%k.length];return z}var q=l.canvas={},F=null,w=v.multiplyPoint,C=Math.PI,I=2*C,D=C/2;h=u.extend;if(x.global.CanvasRenderingContext2D){x=x.doc.createElement("canvas").getContext("2d");var K="function"==typeof x.setLineDash,
O="function"==typeof x.fillText}var M={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};q.Shape=t("dojox.gfx.canvas.Shape",f.Shape,{_render:function(e){e.save();this._renderTransform(e);this._renderClip(e);this._renderShape(e);this._renderFill(e,!0);this._renderStroke(e,!0);e.restore()},_renderClip:function(e){this.canvasClip&&(this.canvasClip.render(e),
e.clip())},_renderTransform:function(e){if("canvasTransform"in this){var k=this.canvasTransform;e.translate(k.dx,k.dy);e.rotate(k.angle2);e.scale(k.sx,k.sy);e.rotate(k.angle1)}},_renderShape:function(e){},_renderFill:function(e,k){if("canvasFill"in this){var m=this.fillStyle;if("canvasFillImage"in this){var a=m.width,c=m.height,b=this.canvasFillImage.width,d=this.canvasFillImage.height,f=Math.min(a==b?1:a/b,c==d?1:c/d),g=(a-f*b)/2,h=(c-f*d)/2;F.width=a;F.height=c;var l=F.getContext("2d");l.clearRect(0,
0,a,c);l.drawImage(this.canvasFillImage,0,0,b,d,g,h,f*b,f*d);this.canvasFill=e.createPattern(F,"repeat");delete this.canvasFillImage}e.fillStyle=this.canvasFill;k&&("pattern"!==m.type||0===m.x&&0===m.y||e.translate(m.x,m.y),e.fill())}else e.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(e,k){var m=this.strokeStyle;m?(e.strokeStyle=m.color.toString(),e.lineWidth=m.width,e.lineCap=m.cap,"number"==typeof m.join?(e.lineJoin="miter",e.miterLimit=m.join):e.lineJoin=m.join,this.canvasDash?K?(e.setLineDash(this.canvasDash),
k&&e.stroke()):this._renderDashedStroke(e,k):k&&e.stroke()):k||(e.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(e,k){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(e){this.inherited(arguments);var k=e?"width"in e?"rect":"cx"in e?"ellipse":"points"in e?"polyline":"d"in e?"path":null:null;if(e&&!k)return this;this.canvasClip=e?P(k,e):null;this.parent&&this.parent._makeDirty();return this}});var P=
function(e,k){switch(e){case "ellipse":return{canvasEllipse:L({shape:k}),render:function(e){return q.Ellipse.prototype._renderShape.call(this,e)}};case "rect":return{shape:u.delegate(k,{r:0}),render:function(e){return q.Rect.prototype._renderShape.call(this,e)}};case "path":return{canvasPath:Q(k),render:function(e){this.canvasPath._renderShape(e)}};case "polyline":return{canvasPolyline:k.points,render:function(e){return q.Polyline.prototype._renderShape.call(this,e)}}}return null},Q=function(e){var k=
new dojox.gfx.canvas.Path;k.canvasPath=[];k._setPath(e.d);return k},G=function(e,k,m){var a=e.prototype[k];e.prototype[k]=m?function(){this.parent&&this.parent._makeDirty();a.apply(this,arguments);m.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return a.apply(this,arguments)}};G(q.Shape,"setTransform",function(){this.matrix?this.canvasTransform=l.decompose(this.matrix):delete this.canvasTransform});G(q.Shape,"setFill",function(){var e=this.fillStyle,k;if(e){if("object"==
typeof e&&"type"in e){var m=this.surface.rawNode.getContext("2d");switch(e.type){case "linear":case "radial":k="linear"==e.type?m.createLinearGradient(e.x1,e.y1,e.x2,e.y2):m.createRadialGradient(e.cx,e.cy,0,e.cx,e.cy,e.r);n.forEach(e.colors,function(e){k.addColorStop(e.offset,l.normalizeColor(e.color).toString())});break;case "pattern":F||(F=document.createElement("canvas")),m=new Image,this.surface.downloadImage(m,e.src),this.canvasFillImage=m}}else k=e.toString();this.canvasFill=k}else delete this.canvasFill});
G(q.Shape,"setStroke",function(){var e=this.strokeStyle;if(e){var k=this.strokeStyle.style.toLowerCase();k in M&&(k=M[k]);if(k instanceof Array){this.canvasDash=k=k.slice();var m;for(m=0;m<k.length;++m)k[m]*=e.width;if("butt"!=e.cap){for(m=0;m<k.length;m+=2)k[m]-=e.width,1>k[m]&&(k[m]=1);for(m=1;m<k.length;m+=2)k[m]+=e.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!K&&!!this.canvasDash});G(q.Shape,"setShape");q.Group=t("dojox.gfx.canvas.Group",q.Shape,{constructor:function(){f.Container._init.call(this)},
_render:function(e){e.save();this._renderTransform(e);this._renderClip(e);for(var k=0;k<this.children.length;++k)this.children[k]._render(e);e.restore()},destroy:function(){f.Container.clear.call(this,!0);q.Shape.prototype.destroy.apply(this,arguments)}});q.Rect=t("dojox.gfx.canvas.Rect",[q.Shape,f.Rect],{_renderShape:function(e){var k=this.shape,m=Math.min(k.r,k.height/2,k.width/2),a=k.x,c=a+k.width,b=k.y,k=b+k.height,d=a+m,f=c-m,g=b+m,h=k-m;e.beginPath();e.moveTo(d,b);m?(e.arc(f,g,m,-D,0,!1),e.arc(f,
h,m,0,D,!1),e.arc(d,h,m,D,C,!1),e.arc(d,g,m,C,C+D,!1)):(e.lineTo(f,b),e.lineTo(c,h),e.lineTo(d,k),e.lineTo(a,g));e.closePath()},_renderDashedStroke:function(e,k){var m=this.shape,a=Math.min(m.r,m.height/2,m.width/2),c=m.x,b=c+m.width,d=m.y,f=d+m.height,g=c+a,h=b-a,l=d+a,n=f-a;a?(e.beginPath(),m=r(e,this,g,d,h,d),k&&e.stroke(),m=B(e,this.canvasDash,h,l,a,-D,0,!1,k,m),e.beginPath(),m=r(e,this,b,l,b,n,m),k&&e.stroke(),m=B(e,this.canvasDash,h,n,a,0,D,!1,k,m),e.beginPath(),m=r(e,this,h,f,g,f,m),k&&e.stroke(),
m=B(e,this.canvasDash,g,n,a,D,C,!1,k,m),e.beginPath(),m=r(e,this,c,n,c,l,m),k&&e.stroke(),B(e,this.canvasDash,g,l,a,C,C+D,!1,k,m)):(e.beginPath(),m=r(e,this,g,d,h,d),m=r(e,this,h,d,b,n,m),m=r(e,this,b,n,g,f,m),r(e,this,g,f,c,l,m),k&&e.stroke())}});var E=[];(function(){var e=c.curvePI4;E.push(e.s,e.c1,e.c2,e.e);for(var k=45;360>k;k+=45){var m=v.rotateg(k);E.push(w(m,e.c1),w(m,e.c2),w(m,e.e))}})();var L=function(e){var k,m,a,c=[],b=e.shape,d=v.normalize([v.translate(b.cx,b.cy),v.scale(b.rx,b.ry)]);
k=w(d,E[0]);c.push([k.x,k.y]);for(b=1;b<E.length;b+=3)m=w(d,E[b]),a=w(d,E[b+1]),k=w(d,E[b+2]),c.push([m.x,m.y,a.x,a.y,k.x,k.y]);if(e._needsDash){k=[];m=c[0];for(b=1;b<c.length;++b)a=[],A(m.concat(c[b]),e.canvasDash,a),m=[c[b][4],c[b][5]],k.push(a);e._dashedPoints=k}return c};q.Ellipse=t("dojox.gfx.canvas.Ellipse",[q.Shape,f.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=L(this);return this},setStroke:function(){this.inherited(arguments);K||(this.canvasEllipse=L(this));
return this},_renderShape:function(e){var k=this.canvasEllipse,a;e.beginPath();e.moveTo.apply(e,k[0]);for(a=1;a<k.length;++a)e.bezierCurveTo.apply(e,k[a]);e.closePath()},_renderDashedStroke:function(e,a){var k=this._dashedPoints;e.beginPath();for(var c=0;c<k.length;++c)for(var b=k[c],d=0;d<b.length;++d){var f=b[d];e.moveTo(f[0],f[1]);e.bezierCurveTo(f[2],f[3],f[4],f[5],f[6],f[7])}a&&e.stroke()}});q.Circle=t("dojox.gfx.canvas.Circle",[q.Shape,f.Circle],{_renderShape:function(e){var a=this.shape;e.beginPath();
e.arc(a.cx,a.cy,a.r,0,I,1)},_renderDashedStroke:function(e,a){var k=this.shape,c=0,b,d=this.canvasDash.length;for(i=0;c<I;)b=this.canvasDash[i%d]/k.r,i%2||(e.beginPath(),e.arc(k.cx,k.cy,k.r,c,c+b,0),a&&e.stroke()),c+=b,++i}});q.Line=t("dojox.gfx.canvas.Line",[q.Shape,f.Line],{_renderShape:function(e){var a=this.shape;e.beginPath();e.moveTo(a.x1,a.y1);e.lineTo(a.x2,a.y2)},_renderDashedStroke:function(e,a){var k=this.shape;e.beginPath();r(e,this,k.x1,k.y1,k.x2,k.y2);a&&e.stroke()}});q.Polyline=t("dojox.gfx.canvas.Polyline",
[q.Shape,f.Polyline],{setShape:function(){this.inherited(arguments);var e=this.shape.points,a=e[0],c,b;this.bbox=null;this._normalizePoints();if(e.length)if("number"==typeof a)a=e;else for(a=[],b=0;b<e.length;++b)c=e[b],a.push(c.x,c.y);else a=[];this.canvasPolyline=a;return this},_renderShape:function(a){var e=this.canvasPolyline;if(e.length){a.beginPath();a.moveTo(e[0],e[1]);for(var c=2;c<e.length;c+=2)a.lineTo(e[c],e[c+1])}},_renderDashedStroke:function(a,c){var e=this.canvasPolyline,k=0;a.beginPath();
for(var b=0;b<e.length;b+=2)k=r(a,this,e[b],e[b+1],e[b+2],e[b+3],k);c&&a.stroke()}});q.Image=t("dojox.gfx.canvas.Image",[q.Shape,f.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var e=this.shape;a.drawImage(this.canvasImage,e.x,e.y,e.width,e.height)}});q.Text=t("dojox.gfx.canvas.Text",[q.Shape,f.Text],{_setFont:function(){this.fontStyle?this.canvasFont=l.makeFontString(this.fontStyle):
delete this.canvasFont},getTextWidth:function(){var a=this.shape,c=0,b;a.text&&(b=this.surface.rawNode.getContext("2d"),b.save(),this._renderTransform(b),this._renderFill(b,!1),this._renderStroke(b,!1),this.canvasFont&&(b.font=this.canvasFont),c=b.measureText(a.text).width,b.restore());return c},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var e=this.shape;e.text&&(a.textAlign="middle"===
e.align?"center":e.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(e.text,e.x,e.y),this.strokeStyle&&(a.beginPath(),a.strokeText(e.text,e.x,e.y),a.closePath()))}});G(q.Text,"setFont");O||q.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var R={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",
Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};q.Path=t("dojox.gfx.canvas.Path",[q.Shape,b.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);K||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var e=
u.clone(this.last);this[R[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=e;this.inherited(arguments)},_renderShape:function(a){var e=this.canvasPath;a.beginPath();for(var c=0;c<e.length;c+=2)a[e[c]].apply(a,e[c+1])},_renderDashedStroke:K?function(){}:function(a,c){var e=this._dashedPath;a.beginPath();for(var b=0;b<e.length;b+=2)a[e[b]].apply(a,e[b+1]);c&&a.stroke()},_moveToA:function(a,c,b,d){a.push("moveTo",[b[0],b[1]]);d&&d.push("moveTo",[b[0],b[1]]);
for(c=2;c<b.length;c+=2)a.push("lineTo",[b[c],b[c+1]]),d&&(this._dashResidue=r(d,this,b[c-2],b[c-1],b[c],b[c+1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_moveToR:function(a,c,b,d){c="x"in this.last?[this.last.x+=b[0],this.last.y+=b[1]]:[this.last.x=b[0],this.last.y=b[1]];a.push("moveTo",c);d&&d.push("moveTo",c);for(c=2;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=b[c+1]]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-
1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,c,b,d){for(c=0;c<b.length;c+=2)d&&(this._dashResidue=r(d,this,this.last.x,this.last.y,b[c],b[c+1],this._dashResidue)),a.push("lineTo",[b[c],b[c+1]]);this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_lineToR:function(a,c,b,d){for(c=0;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=b[c+1]]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,
this._dashResidue));this.lastControl={}},_hLineToA:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[b[c],this.last.y]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-1][1],b[c],this.last.y,this._dashResidue));this.last.x=b[b.length-1];this.lastControl={}},_hLineToR:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x+=b[c],this.last.y]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl=
{}},_vLineToA:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,b[c]]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,b[c],this._dashResidue));this.last.y=b[b.length-1];this.lastControl={}},_vLineToR:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,this.last.y+=b[c]]),d&&(this._dashResidue=r(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,c,b,d){for(c=
0;c<b.length;c+=6)a.push("bezierCurveTo",b.slice(c,c+6)),d&&(this._dashResidue=y(d,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="C"},_curveToR:function(a,c,b,d){for(c=0;c<b.length;c+=6)a.push("bezierCurveTo",[this.last.x+b[c],this.last.y+b[c+1],this.lastControl.x=this.last.x+b[c+2],this.lastControl.y=this.last.y+b[c+3],this.last.x+b[c+4],this.last.y+b[c+5]]),d&&(this._dashResidue=
y(d,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+4],this.last.y+=b[c+5];this.lastControl.type="C"},_smoothCurveToA:function(a,c,b,d){for(c=0;c<b.length;c+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,b[c],b[c+1],b[c+2],b[c+3]]);d&&(this._dashResidue=y(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=b[c];this.lastControl.y=b[c+1];this.lastControl.type="C"}this.last.x=
b[b.length-2];this.last.y=b[b.length-1]},_smoothCurveToR:function(a,c,b,d){for(c=0;c<b.length;c+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+b[c],this.last.y+b[c+1],this.last.x+b[c+2],this.last.y+b[c+3]]);d&&(this._dashResidue=y(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+b[c];this.lastControl.y=this.last.y+b[c+1];this.lastControl.type="C";this.last.x+=
b[c+2];this.last.y+=b[c+3]}},_qCurveToA:function(c,a,b,d){for(a=0;a<b.length;a+=4)c.push("quadraticCurveTo",b.slice(a,a+4));d&&(this._dashResidue=y(d,this,c[c.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,c,b,d){for(c=0;c<b.length;c+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+b[c],this.lastControl.y=this.last.y+b[c+1],this.last.x+b[c+
2],this.last.y+b[c+3]]),d&&(this._dashResidue=y(d,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+2],this.last.y+=b[c+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(c,a,b,d){for(a=0;a<b.length;a+=2){var e="Q"==this.lastControl.type;c.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,b[a],b[a+1]]);d&&(this._dashResidue=y(d,this,c[c.length-1],this._dashResidue));this.lastControl.type=
"Q"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_qSmoothCurveToR:function(c,b,a,d){for(b=0;b<a.length;b+=2){var e="Q"==this.lastControl.type;c.push("quadraticCurveTo",[this.lastControl.x=e?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+a[b],this.last.y+a[b+1]]);d&&(this._dashResidue=y(d,this,c[c.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=a[b];this.last.y+=a[b+1]}},_arcTo:function(b,a,d,f){a=
"a"==a;for(var e=0;e<d.length;e+=7){var g=d[e+5],k=d[e+6];a&&(g+=this.last.x,k+=this.last.y);var h=c.arcAsBezier(this.last,d[e],d[e+1],d[e+2],d[e+3]?1:0,d[e+4]?1:0,g,k);n.forEach(h,function(a){b.push("bezierCurveTo",a)});f&&(this._dashResidue=y(f,this,p,this._dashResidue));this.last.x=g;this.last.y=k}this.lastControl={}},_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=r(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});n.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),
function(a){G(q.Path,a)});q.TextPath=t("dojox.gfx.canvas.TextPath",[q.Shape,b.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});q.Surface=t("dojox.gfx.canvas.Surface",f.Surface,{constructor:function(){f.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){f.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=l.normalizedLength(a);this.height=l.normalizedLength(b);if(!this.rawNode)return this;
a=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,a=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,a=!0);a&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),
delete this.pendingRender))},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(u.hitch(this,this._render),0))},downloadImage:function(a,b){var c=u.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=
b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});q.createSurface=function(a,b,c){if(!b&&!c){var e=g.position(a);b=b||e.w;c=c||e.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");e=new q.Surface;a=d.byId(a);var f=a.ownerDocument.createElement("canvas");f.width=l.normalizedLength(b);f.height=l.normalizedLength(c);a.appendChild(f);
e.rawNode=f;e._parent=a;return e.surface=e};var H=f.Container;t={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return H.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return H.remove.apply(this,arguments)},clear:function(){this._makeDirty();return H.clear.apply(this,arguments)},getBoundingBox:H.getBoundingBox,
_moveChildToFront:function(a){this._makeDirty();return H._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return H._moveChildToBack.apply(this,arguments)}};b={createObject:function(a,b){a=new a;a.surface=this.surface;a.setShape(b);this.add(a);return a}};h(q.Group,t);h(q.Group,f.Creator);h(q.Group,b);h(q.Surface,t);h(q.Surface,f.Creator);h(q.Surface,b);q.fixTarget=function(a,b){return!0};return q});