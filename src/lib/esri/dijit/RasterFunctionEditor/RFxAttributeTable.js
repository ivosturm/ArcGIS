// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/RasterFunctionEditor/templates/RFxAttributeTable.html":'\x3cdiv class\x3d"esriRFxAttributeTable"\x3e\r\n    \x3ctable class\x3d"esriRFxAttributeTable__table"\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-name"\x3e\r\n          \x3ctd data-dojo-attach-point\x3d"rasterLabel"\x3e\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-widget"\x3e\r\n        \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"esri/dijit/RasterFunctionEditor/RFxRasterInput" data-dojo-attach-point\x3d"_layerSelect" data-dojo-props\x3d"inputLayers: this.inputLayers, allowScalar: this.allowScalar"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \r\n    \x3cdiv data-dojo-attach-point\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \r\n    \x3cdiv class\x3d"esriGenerateTableOptions" data-dojo-attach-point\x3d"generateOptions" data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"title: \'${_i18n.generateTable}\', open: false"\x3e\r\n      \x3ctable\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.minVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"minValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.maxVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.baseClassName}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"baseClassNameInput" value\x3d"${_i18n.defaultClassName}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.colorScheme}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"colorRampNode"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n      \x3cbutton class\x3d"esriAttributeTableGenerateTable" data-dojo-attach-point\x3d"generateButton" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${_i18n.generateTable}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n   \r\n  \x3c/div\x3e\r\n  '}});
define("esri/dijit/RasterFunctionEditor/RFxAttributeTable","dojo/_base/declare dojo/_base/lang dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/RFxAttributeTable.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/NumberSpinner ./EditableGridMixin ./RFxGridBase ../ColorRampSelector ../../renderers/colorRampUtils ../../kernel".split(" "),function(e,d,h,k,l,m,n,p,q,r,g,t,u,v){e=e([m,n,p,r],{templateString:l,baseClass:"esriRFxAttributeTable",nCols:0,dataTypes:[g.DATA_TYPES.string,
g.DATA_TYPES.string,"color"],fieldNames:["Value","ClassName","Color"],isExternalTable:!1,_store:null,_grid:null,defaults:{min:1,max:7},fields:[{name:"ObjectID",type:"esriFieldTypeOID",alias:"OID"},{name:"Value",type:"esriFieldTypeInteger",alias:"Value"},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",length:256},{name:"Red",type:"esriFieldTypeInteger",alias:"Red"},{name:"Green",type:"esriFieldTypeInteger",alias:"Green"},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue"},{name:"Alpha",
type:"esriFieldTypeInteger",alias:"Alpha"}],fieldTypeMap:{esriFieldTypeOID:"double",esriFieldTypeInteger:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"string"},constructor:function(a){this.inherited(arguments);this._i18n=k.widgets.rasterFunctionEditor.rfxAttributeTable},postCreate:function(){this.inherited(arguments);this._validateInputArgs();this._setLabels();this._setupLayerSelect();this._setupValueControls();this._setupColorRamp();this._initializeGrid();
this.generateButton.on("click",d.hitch(this,this._onGenerateTableClick));this._grid.on("grid-data-change",d.hitch(this,this._updateValue))},_validateInputArgs:function(){var a=Object.keys(this.inputArgs).some(function(b){if("AttributeTableAsRecordSet"===b)return!0});if(!a){var c={name:"AttributeTableAsRecordSet",isPublic:!1,type:"RecordSet"};this.rfxArgs.AttributeTableAsRecordSet=c;this.inputArgs.AttributeTableAsRecordSet=c}a&&(this.isExternalTable=this._isExternalTable())&&(this.generateOptions.domNode.style.display=
"none")},_setupLayerSelect:function(){this.rasterArg=this.inputArgs&&this.inputArgs.Raster;this._layerSelect.set("inputLayers",this.inputLayers);this._layerSelect.set("allowScalar",this.allowScalar);this._layerSelect.set("rfxVariable",this.rasterArg);this.own(this._layerSelect.on("change",this._updateRasterInputArg.bind(this)))},_updateRasterInputArg:function(){this.rasterArg.value=this._layerSelect.get("value")},_setupValueControls:function(){this.minVal=this._createValueControl(this.minValSelect,
this.defaults.min);this.maxVal=this._createValueControl(this.maxValSelect,this.defaults.max)},_setupColorRamp:function(){this.colorRampSelect=new t({maxHeight:200,includeDefault:!1},this.colorRampNode);this.colorRampSelect.startup();this.colorRampSelect.setSelected("Aspect")},_createValueControl:function(a,c){a=new q({value:c,smallDelta:1,constraints:{min:-127,max:127,places:0}},a);a.startup();return a},_initializeGrid:function(){var a=this._getGridSchema(),c=this._createDataObject();this._grid=this.isExternalTable?
new g({schema:a,data:c,hasIdColumn:!1,isEditable:!1},this.attributeTable):new g({schema:a,data:c,hasIdColumn:!0,defaultBlankObject:this._getDefaultValueObject()},this.attributeTable)},_getGridSchema:function(){var a=[];return a=this.isExternalTable?(this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet&&this.inputArgs.AttributeTableAsRecordSet.fields).map(d.hitch(this,function(a){return{label:this._i18n[a.name.toLowerCase()]||a.name,name:a.name,dataType:this.fieldTypeMap[a.type]}})):this.fieldNames.map(function(a,
b){return{label:this._i18n[a.toLowerCase()],name:a,dataType:this.dataTypes[b]}},this)},_isExternalTable:function(){var a=!1,c=this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet&&this.inputArgs.AttributeTableAsRecordSet.fields;c.length===this.fields.length?c.forEach(d.hitch(this,function(b){"oid"===b.name.toLowerCase()||this.fields.some(d.hitch(this,function(a){return a.name===b.name&&a.type===b.type&&a.alias===b.alias}))||(a=!0)})):a=!0;return a},_createDataObject:function(){var a=[];if((this.recordSetArg=
this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet)&&this.recordSetArg.features&&this.recordSetArg.features.length){var c=this.recordSetArg.features;this.isExternalTable?a=c.map(function(a){return a.attributes}):c.forEach(function(b){b=b.attributes;a.push({Value:b.Value,ClassName:b.ClassName,colorObject:{r:b.Red,g:b.Green,b:b.Blue,a:b.Alpha,id:b.ObjectID}})})}return a},_getDefaultValueObject:function(){if(!this.isExternalTable)return{Value:0,ClassName:"",colorObject:{r:0,g:0,b:0,a:1}}},_onGenerateTableClick:function(){var a=
this._getGridData();this._grid.updateStoreValue(a);this._updateValue(a)},_getGridData:function(){for(var a=this.minVal.value,c=this.maxVal.value,b=this.baseClassNameInput.value,d=[],e=u.convertColorRampToColormap(this.colorRampSelect.colorRamp,c-a+1),f=0;a<=c;a++)d.push({Value:a,ClassName:b+a,colorObject:{r:e[f][1],g:e[f][2],b:e[f][3],a:1,id:f}}),f++;return d},_updateValue:function(a){var c=[];a.forEach(function(a,d){a&&"*"!==a.idNum&&(a={attributes:{ObjectID:d,Value:parseInt(a.Value,10),ClassName:a.ClassName,
Red:a.colorObject.r,Green:a.colorObject.g,Blue:a.colorObject.b,Alpha:a.colorObject.a}},c.push(a))});this.recordSetArg.fields||(this.recordSetArg.fields=this.fields);this.recordSetArg.features=c},_setLabels:function(){this.inputArgs&&this.inputArgs.Raster&&(this.rasterLabel.innerHTML=this.inputArgs.Raster.displayName||this.inputArgs.Raster.name)}});h("extend-esri")&&d.setObject("dijit.RasterFunctionEditor.RFxAttributeTable",e,v);return e});