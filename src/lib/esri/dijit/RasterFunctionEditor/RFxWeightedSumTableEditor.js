// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/RasterFunctionEditor/RFxWeightedSumTableEditor","dojo/_base/declare dojo/has ../../kernel dojo/i18n!../../nls/jsapi dojo/_base/lang dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./EditableGridMixin ./RFxGridBase ./utils".split(" "),function(g,k,l,m,n,p,q,r,t,u,h,v){g=g([q,r,t,p,u],{templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'gridNode'\x3e\x3c/div\x3e\x3c/div\x3e",baseClass:"esriRFxWeightedSumTableEditor",dataTypes:[h.DATA_TYPES.raster,
"field",h.DATA_TYPES.double],fieldNames:["layer","field","weight"],value:null,_store:null,_grid:null,postCreate:function(){this.inherited(arguments);this._i18n=m.widgets.rasterFunctionEditor.rfxWeightedSumTableEditor;this._initializeGrid();this._grid.on("grid-data-change",function(a){this._updateArgValues(a)}.bind(this));this._grid.startup()},_initializeGrid:function(){var a=this._getGridSchema(),c=this._readArgValues();this._grid=new h({schema:a,data:c,hasIdColumn:!0,inputLayers:this.inputLayers,
allowScalar:this.allowScalar,browseProperties:this.browseProperties},this.gridNode)},_getGridSchema:function(){var a=[];return a=this.fieldNames.map(function(a,d){return{label:this._i18n[a],name:a,dataType:this.dataTypes[d]}},this)},_updateArgValues:function(){var a=this.inputArgs,c=this._grid._store.data;if(a){var d=a.Rasters,b=a.Weights,e=a.Fields;d&&(d.value={},d.value.elements=[],d.value.type=v.ARGUMENT_ARRAY_TYPE);b&&(b.value=[]);e&&(e.value=[]);c&&Array.isArray(c)&&c.forEach(function(a){if("*"!==
a.idNum){var c=a.layer;d&&d.value&&d.value.elements.push(c);b&&b.value&&b.value.push(a.weight);e&&e.value&&e.value.push(a.fieldArg.value)}})}},_readArgValues:function(){if(this.inputArgs){var a,c=0,d=[],b=this.inputArgs,e=b.Rasters,f=b.Weights,b=b.Fields;if(e&&f&&b&&(a=Math.max(e.value&&e.value.elements&&e.value.elements.length,f.value&&f.value.length,b.value&&b.value.length),isNaN(a)))return d;for(;c<a;)d.push({layer:e.value&&e.value.elements&&e.value.elements[c],field:b.value&&b.value[c],weight:f.value&&
f.value[c]}),c+=1;return d}}});k("extend-esri")&&n.setObject("dijit.RasterFunctionEditor.RFxWeightedSumTableEditor",g,l);return g});