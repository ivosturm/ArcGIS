// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/analysis/components/DataStoreSelect","../../../kernel ../../../lang ../../../request dijit/_WidgetBase dojox/lang/functional/object dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/has dojo/promise/all dojo/Evented dojo/i18n!../nls/DataStoreSelect".split(" "),function(h,c,e,k,f,l,d,a,m,n,p,q){c=l([k,p],{declaredClass:"esri.dijit.analysis.components.DataStoreSelect",geoAnalyticsServer:null,i18n:null,postMixInProperties:function(){this.inherited(arguments);this.i18n={};
d.mixin(this.i18n,q)},buildRendering:function(){this.createElements()},postCreate:function(){this.inherited(arguments);this.buildDataStoreUI()},createElements:function(){this.domNode=a.create("div",{style:"width:100%;height:100%"});this._dsSelect=a.create("select",{"class":"dijit dijitReset dijitInline dijitLeft dijitDownArrowButton esriLeadingMargin1 longInput esriLongLabel dijitSelect dijitValidationTextBox",onchange:d.hitch(this,this._handleDSSelectChange)},this.domNode)},_handleDSSelectChange:function(a){this.emit("change",
{value:this._dsSelect.value})},buildDataStoreUI:function(){if(this.geoAnalyticsServer&&!this.bdfsTemplateOptions){var b=this.geoAnalyticsServer.replace("/System/GeoAnalyticsTools/GPServer","");e({url:b+"/DataStoreCatalogs",content:{f:"json"}}).then(d.hitch(this,function(c){var g=c.services.map(function(a){return a.name});c=g.map(function(a){return e({url:b+"/"+a+"/BigDataCatalogServer",content:{f:"json"}})});n(c).then(d.hitch(this,function(b){var c=[];b.filter(function(a,b){a.name=g[b];return void 0!==
a.outputTemplates}).forEach(function(a){a.outputTemplates.forEach(function(b){c.push({label:a.name.replace("DataStoreCatalogs/bigDataFileShares_","")+"-"+b.title,innerHTML:a.name.replace("DataStoreCatalogs/bigDataFileShares_","")+"-"+b.title,value:a.name.replace("DataStoreCatalogs/bigDataFileShares_","/bigDataFileShares/")+":"+b.name})})});this.bdfsTemplateOptions=c;b=a.create("optGroup",{label:this.i18n.agsDataStore});var e=a.create("optGroup",{label:this.i18n.bdfsTemplates});b.appendChild(a.create("option",
{label:this.i18n.relationalDS,value:"GDB",innerHTML:this.i18n.relationalDS}));b.appendChild(a.create("option",{label:this.i18n.spatialDS,value:"BDS",innerHTML:this.i18n.spatialDS}));c.forEach(d.hitch(this,function(b){e.appendChild(a.create("option",b))}));this._dsSelect.appendChild(b);this._dsSelect.appendChild(e);f.keys(this._dsSelect.options).some(function(a){return a.label===this.value},this);this._setCurValue()}))}),d.hitch(this,function(){this._dsSelect.add(a.create("option",{label:this.i18n.relationalDS,
value:"GDB",innerHTML:this.i18n.relationalDS}));this._dsSelect.add(a.create("option",{label:this.i18n.spatialDS,value:"BDS",innerHTML:this.i18n.spatialDS}));this._setCurValue()}))}},_setCurValue:function(){f.keys(this._dsSelect.options).some(function(a){return a.label===this.value},this)?this._dsSelect.value=this.value:this._dsSelect.value="BDS"},reset:function(){this._dsSelect.reset()},_setGeoAnalyticsServerAttr:function(a){this.geoAnalyticsServer=a},_setValueAttr:function(a){this.value=a||"BDS"},
_getValueAttr:function(){return this._dsSelect?this._dsSelect.value:null}});m("extend-esri")&&d.setObject("dijit.analysis.components.DataStoreSelect",c,h);return c});