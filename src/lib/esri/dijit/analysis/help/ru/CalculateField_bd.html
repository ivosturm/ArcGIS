<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title></title>
    <link rel="Stylesheet" href="../css/analysis.css" />
    <script type="text/javascript">
        function init() {
            if (window.location.hash) {
                var parentDiv, nodes, i, helpInfo, helpId, helpInfoArr, helpEnvFilter, envContent, hideEnvClass, hideNodes;
                helpInfo = window.location.hash.substring(1);
                    if(helpInfo.indexOf("-")) {
                        helpInfoArr = helpInfo.split("-");
                        helpId = helpInfoArr[0];
                        helpEnvFilter = helpInfoArr[1];
                    }
                    else {
                        helpId = helpInfo;
                    }
                parentDiv = document.getElementById("topics");
                nodes = parentDiv.children;
                    hideEnvClass = (helpEnvFilter === "OnlineOnly"? "PortalOnly": "OnlineOnly");
                    if(document.getElementsByClassName) {
                        hideNodes = document.getElementsByClassName(hideEnvClass);
                    }
                    else {
                        hideNodes = document.querySelectorAll(hideEnvClass);
                    }
                for(i=0; i < nodes.length; i++) {
                    if(nodes[i].id !== helpId) {
                        nodes[i].style.display ="none";
                    }
                    }
                    for(i=0; i < hideNodes.length; i++) {
                        hideNodes[i].style.display ="none";
                    }
                }
            }
    </script>
</head>
<body onload="init()">
<div id="topics">
    <div id="toolDescription" class="largesize">
        <h2>Вычислить поле</h2><p/>
        <h2><img src="../images/GUID-059C9BE7-7B00-49C8-9917-B0EAEA3DA19D-web.png" alt="Вычислить поле"></h2>
        <hr/>
    <p> Этот инструмент работает с входным слоем для вычисления значений в новых или имеющихся полях. Создайте выражение Arcade для вычисления значений, которые будут присваиваться объектам.   Если в данных используется текущее время, дополнительно можно построить выражения с учетом трекинга.
    </p>
    <p>Например, предположим вы хотите изменить поле с именем  <i>TotalSales</i>. Вы хотите, чтобы в поле была представлена сумма всех продаж за 2016 и 2017 годы. Используя эти поля в выражении, вы вычисляете значение поля как <pre>$feature[&quot;Sales2016&quot;] + $feature[&quot;Sales2017&quot;]</pre>.
    </p>
    <p>Используя другой пример, предположим, у вас есть GPS данные местоположений, времени, ID автобуса и скорости автобусов в городе. Мы хотим создать новое поле  <i>SpeedFrom3</i>, в котором усредняется скорость последних 3 GPS-измерений для каждого объекта. Для такого вычисления модно использовать вычисления с учетом трекинга, где треком является автобус, обозначенный своим ID.    Вычисление для определения средней скорости предыдущих 3 временных шагов и текущего шага выглядит так <pre>average($track.field[&quot;speed&quot;].history(-4))</pre>.
    </p>
    </div>
    <!--Parameter divs for each param-->
    <div id="inputLayer">
        <div><h2>Выберите слой, чтобы вычислить значения полей для</h2></div>
        <hr/>
        <div>
            <p>Точки, линии, полигоны или таблицы, в которые будут помещаться вычисленные значения полей.  
            </p>
            <p>Кроме выбора слоя из вашей карты, можно щелкнуть  <b>Выбрать слой анализа</b> в нижней части ниспадающего списка, чтобы найти свои ресурсы для набора данных или векторного слоя файлового хранилища больших данных.
            </p>
        </div>
    </div>
    <div id="fields">
        <div><h2>Вычислить значения для поля</h2></div>
        <hr/>
        <div>
            <p>Новое или имеющееся поле, в котором будут храниться вычисленные значения, и тип этого поля. Если вычисляются значения уже существующего поля, подбирать тип данных не нужно. 
            </p>
        </div>
    </div>
    <div id="expression">
        <div><h2>Построить выражение, чтобы вычислить значения поля</h2></div>
        <hr/>
        <div>
            <p>Добавьте выражение, используя построитель выражений для вычисления значений поля. 
            </p>
            <p>Например, предположим мы хотим добавить значения  <i>income</i> и <i>bonus</i>. Для этого добавьте выражение <code>$feature[&quot;income&quot;] + $feature[&quot;bonus&quot;] </code>.
            </p>
        </div>
    </div>
    <div id="trackInfo">
        <div><h2>В выражении учитывается трекинг</h2></div>
        <hr/>
        <div>
            <p>Укажите, используется ли в выражении трекинг. Выражения с трекингом содержит такой формат  <pre>$track.field[&quot;fieldname&quot;].history(...)</pre>. Для выражений с трекингом требуются поля для идентификации отдельных треков. Треки могут состоять из точек, линий, полигонов или таблиц, необходимо только, чтобы входные данные имели идентификатор трека и временные данные текущего типа.
            </p>
        </div>
    </div>
    <div id="timeBoundarySplit">
        <div><h2>Анализ данных с временными интервалами</h2></div>
        <hr/>
        <div>
            <p>Укажите, хотите ли вы вычислить значения треков, используя временные интервалы, которые разделяют входные данные для анализа. Если вы используете интервалы, необходимо задать его, а также, дополнительно, настроить базовое время. Если базовое время не настроено, используется 1 января 1970. 
            </p>
            <p>Например, если вы выбрали интервал в 1 день, начиная с  9:00 1 января 1990, каждый трек будет обрезан в 9:00 каждого дня и проанализирован в пределах этого сегмента. 
            </p>
            <p>Использование интервалов позволяет ускорить обработку, т.к. небольшие треки для анализа создаются быстрее. Если разбиение на повторяющиеся интервалы может влиять на результаты анализа, рекомендуется использовать обработку больших данных.
            </p>
        </div>
    </div>
    <div id="outputName">
        <div><h2>Имя слоя результата</h2></div>
        <hr/>
        <div>
            <p> Имя создаваемого слоя. Если вы записываете в ArcGIS Data Store, ваши результаты будут сохранены в  <b>Моих ресурсах</b> и добавлены на карту. Если вы записываете в файловое хранилище больших данных, ваши результаты будут сохранятся в файловом хранилище больших данных и добавляться в его файл манифеста. Они не будут добавлены на карту. Имя слоя по умолчанию зависит от имени инструмента и имени входного слоя. Если слой уже существует, произойдет сбой.
            </p>
            <p>При записи в  ArcGIS Data Store (реляционное или пространственно-временное хранилище больших данных) с помощью ниспадающего списка поля  <b>Сохранить результат в</b> вы можете задать имя папки в разделе <b>Мои ресурсы</b>, в которую будет записан результат.
            </p>
        </div>
    </div>
</div>
</html>
