// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/InfographicsConfig","esri/declare dojo/_base/lang ./_Wizard ./InfographicsOptions ./InfographicsMainPage ./DataBrowser dojo/i18n!esri/nls/jsapi".split(" "),function(p,c,q,k,r,t,v){function u(b,d){var a=b.length-d.length;return 0>a?!1:b.indexOf(d,a)===a}return p("esri.dijit.geoenrichment.InfographicsConfig",[q],{options:null,startup:function(){this._started||(this.inherited(arguments),this.pages.m=new r({onAddVariables:c.hitch(this,this._addVariables),onOK:c.hitch(this,
this._onOK),onCancel:c.hitch(this,this._onCancel)}),this.options||this.set("options",new k),this.loadPage("m"))},_setOptionsAttr:function(b){this._set("options",b);this.pages.m.set("options",b)},_getCountryIDAttr:function(){return this.pages.m.get("countryID")},_setCountryIDAttr:function(b){this.pages.m.set("countryID",b)},_addVariables:function(){var b=this,d=this.get("countryID"),a=this.pages.db;a?a.set("countryID",d):(a=new t({countryID:d,countryBox:!1,title:this.pages.m.nls.mainTitle}),a.on("back",
c.hitch(this,this.loadPage,"m")),a.on("cancel",c.hitch(this,this._onCancel)),a.on("ok",c.hitch(this,this._applyVariables)),this.pages.db=a);var l=[];this.options.getItems(d).then(function(d){for(var c=0;c<d.length;c++){var f=d[c];"OneVar"==f.type&&1==f.variables.length&&l.push(f.variables[0])}a.set("selection",l);b.loadPage("db");a.launch()})},_applyVariables:function(){function b(a){for(var d=0;d<c.length;d++);return null[a]}for(var d=this,a=this.pages.m.get("countryID"),c=this.pages.db.variables.dataCollections.data,
g={},m=this.pages.db.get("selection"),f=0;f<m.length;f++){var e=m[f];if(u(e,".*"))for(var e=e.split(".")[0],e=b(e).variables,h=0;h<e.length;h++)g[e[h].fullName]=!0;else g[e]=!0}var n=this.pages.db.variables;this.options.getItems(a).then(function(a){var c,b;for(c=a.length-1;0<=c;c--)if(b=a[c],"OneVar"==b.type&&1==b.variables.length){var e=n.get(b.variables[0]);e&&g[e.fullName]?delete g[e.fullName]:a.splice(c,1)}for(var f in g)e=n.get(f),b=new k.Item("OneVar",[f]),b.title=e.alias,a.push(b);d.loadPage("m");
d.pages.m.set("options",d.options)})},_onOK:function(){this.emit("ok")},_onCancel:function(){this.emit("cancel")}})});