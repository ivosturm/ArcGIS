// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_GaugeChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartJsonUtil ../../ChartLineStyles ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../utils/ChartDataUtil ../utils/TooltipInfoBuilder esri/dijit/geoenrichment/utils/ColorUtil".split(" "),function(E,v,F,l,w,G,x,H,y){var I={calcLineStyle:function(b,g){return{color:y.getColorWithAlpha(g.outlineColor||
b,g.outlineOpacity),width:g.outlineThickness,style:l.toGFXValue(g.outlineStyle||l.SOLID)}}};return{calcSeries:function(b){var g=b.seriesItems,h=b.chartType,l=b.themeSettings,J=b.viewModel,c=b.visualProperties,K=b.currentFeatureIndex;b=[];var z=g[0],A={name:"data",data:[]},k=[],m=0,B=0,n=1E6,p=-1E6,C,e=z.points;1===e.length&&(e=e.slice(),e.push(F.getGaugeOthersPoint()));if(v.isConditionalStylingSupported(h)&&c.conditionalStyling){var D=w.getStatistics(c.conditionalStyling);C=D&&x.getChartData({conditionalStats:D,
numPoints:e.length})}var L=G.isFieldInfoInPercentState(e[0].fieldInfo);e.forEach(function(a,d){1!==d?a=x.getPointValue({point:a,index:0,seriesIndex:0,maxValue:!1,chartType:h,visualProperties:c,viewModel:J,currentFeatureIndex:K,chartData:C}):(a=k[0],a=c.gaugeRangeMax?Math.max(0,c.gaugeRangeMax-a):L?Math.max(0,100-a):0);a=(k[d]=a)||0;m+=a;B+=Math.abs(a);n=Math.min(n,a);p=Math.max(p,a)});0===k[1]&&(e.length=1);var M=m/e.length,N=0>c.gaugeRangeMin||0>k[0];e.forEach(function(a,d){var b=1===d,q=k[d],r=
q||0,f;v.isConditionalStylingSupported(h)&&c.conditionalStyling&&(f=(f=w.getConditionalStyle(r,c.conditionalStyling))&&f.backgroundColor,b&&!c.gaugeConditionalStylingOthers&&(f=void 0));f=f||E.calcColorForPoint({point:a,seriesItem:z,pointIndex:d,isOthersPoint:b,seriesIndex:0,numSeries:g.length,chartType:h,themeSettings:l});var t=I.calcLineStyle(f,c);f=1>c.fillOpacity?y.getColorWithAlpha(f,c.fillOpacity):f;var u=r;b||c.gaugeRangeMin&&(u=Math.max(0,u-c.gaugeRangeMin));d={originalValue:q,x:1,y:Math.max(1E-4,
u),isUnavailableData:isNaN(q),valueProp:"y",unsortedIndex:d,name:a.label,point:a,fill:f,fieldInfo:e[0].fieldInfo,seriesIndex:0,isOthersPoint:b,stroke:{color:t.color,width:t.width,style:t.style}};a=H.getTooltipInfo({yValue:r,pointLabel:a.label,seriesLabel:null,minInSeriesValue:n,maxInSeriesValue:p,sumInSeriesValue:m,absSumInSeriesValue:B,avgInSeriesValue:M,visualProperties:c,chartType:h,conditionalStyling:c.conditionalStyling,fieldInfo:e[0].fieldInfo,decimals:a.value&&a.value.decimals,hasNegativeValues:N,
fill:d.fill,stroke:0<d.stroke.width?d.stroke.color:void 0});d.tooltip=a;A.data.push(d)});b.push(A);return b}}});