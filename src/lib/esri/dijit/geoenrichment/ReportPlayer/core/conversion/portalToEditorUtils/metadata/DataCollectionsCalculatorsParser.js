// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/DataCollectionsCalculatorsParser",["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../../_devConfig"],function(f,h,k){return{parseDataCollectionsCalculators:function(l,g,b){f.queryJson(l,"DataCollections").forEach(function(c){var e=f.queryJson(c,"ComparisonLevel");if(k.emulateErrors.metadataParseError)throw Error("Error test: something crashed during the parsing of the metadata!");
var d;if(b.variableProvider.isPlayerOnly||e.length)d=h.getObjects(c);e.length&&(c={calculatorName:c.attributes.Name,levels:e.map(function(a){return a.attributes.Name}).filter(function(a){return!b.validateGeographyLevelFunc||b.validateGeographyLevelFunc(a)}),variableObjects:d.variableObjects},g&&(g.metadata.comparisonCalculatorsHash[c.calculatorName]=c));b.variableProvider.isPlayerOnly&&(d.variableObjects.forEach(function(a){b.variableProvider.addVariable(a)}),d.scriptObjects.forEach(function(a){b.variableProvider.addScriptVariable(a)}))})}}});