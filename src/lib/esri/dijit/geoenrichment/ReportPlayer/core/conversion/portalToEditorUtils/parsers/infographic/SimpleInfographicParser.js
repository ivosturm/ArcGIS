// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/infographic/SimpleInfographicParser","dojo/_base/lang ../../../ConversionUtil esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder dojo/i18n!esri/nls/jsapi".split(" "),function(w,k,u,c,x,l){l=l.geoenrichment.dijit.ReportPlayer.ReportPlayer;
return{portalToEditor:function(b,d){function m(a){return d.parsers.getParser("section").parseTable(a,d)}var v=b.tags.slice(),n,q=[],r,t;(function(){1.1<=d.revisionVersion?v.forEach(function(a){switch(a.attributes.type){case c.INFOGRAPHIC_HEADER:n=a.tags[0];break;case c.INFOGRAPHIC_VARIABLE:q.push(a);break;case c.INFOGRAPHIC_BACKGROUND:r=a.tags;break;case c.INFOGRAPHIC_FOREGROUND:t=a.tags}}):q=v.filter(function(a){return"infographicHeader"===a.attributes.type?(n=a,!1):!0})})();var p={type:b.attributes.type,
isDefault:b.attributes.isDefault,style:{width:k.ptToPx(b.attributes.width),height:k.ptToPx(b.attributes.height),padding:b.attributes.padding?k.ptToPx(b.attributes.padding):void 0,backgroundColor:b.attributes.backgroundColor},preserveTextSize:b.attributes.preserveTextSizeWhenResizing,background:r?r.map(m):null,header:n&&m(n),variableTables:null,foreground:t?t.map(m):null,dataDrilling:null};p.variableTables=q.map(function(a){var b={style:k.ptToPxObj({left:a.attributes.left,top:a.attributes.top,width:a.attributes.width,
height:a.attributes.height})},f;a.tags.forEach(function(a){if("dataDrillingPanels"===a.name)f=a;else{var c=a.attributes.type,g=m(a),e=g.data.data[0],h=g.data.columns[0].field;a={isContrastColor:a.attributes.isContrastColor,isHighlighted:a.attributes.isHighlighted,style:w.mixin({width:g.data.columns[0].style.width,height:e.style.height,left:g.style.left,top:g.style.top},e.style.fields[h])};delete a.style.overrideStyle;"shape"===c&&(a.shapeJson=e.fieldInfos[h].shapeJson,1.6>d.revisionVersion&&(a.style.width-=
3,a.style.height-=3,a.shapeJson.style.width-=3,a.shapeJson.style.height-=3));"image"===c?a.imageJson=e.fieldInfos[h].imageJson:"variable"===c?a.fieldInfo=e.fieldInfos[h]||x.createFieldInfoFromMissingVariable():"description"===c&&(a.text=e[h]);b[c]=a}});if((a=b.variable&&b.variable.fieldInfo)&&a.isMissing){a.alias=b.description&&b.description.text;if(!a.alias&&d.variableProvider.isPlayerOnly){var c=d.variableProvider.toCalculator(a.templateName);a.alias=c&&c.variable.alias}a.alias=a.alias?a.alias+
" ("+l.missingVariable+")":l.missingVariable}f&&f.tags&&f.tags.length&&(a=f.tags[0],a.attributes&&a.attributes.isStandard?u.setDataDrilling(p,b.variable.fieldInfo.templateName,{isStandard:!0,standardId:a.attributes.standardId}):(a=a.tags&&a.tags[0])&&"section"===a.name&&u.setDataDrilling(p,b.variable.fieldInfo.templateName,{sectionJson:d.parsers.getParser("section").parseSection(a,d)}));return b});return p}}});