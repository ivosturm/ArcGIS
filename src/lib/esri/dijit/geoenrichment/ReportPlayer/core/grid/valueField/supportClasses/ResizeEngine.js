// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/valueField/supportClasses/ResizeEngine","dojo/on dojo/dom-style esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/utils/MathUtil esri/dijit/geoenrichment/utils/MouseUtil".split(" "),function(x,z,y,A,g,v){var u={ALL_DIRECTIONS:"e se s sw w nw n ne".split(" "),trackSizer:function(b){var c=u._getSizerInfo(b),k,e=v.getCursorPosition().clientX,l=v.getCursorPosition().clientY,a=b.w,f=b.h,t=
0,r=0,m=x(document.body,"mousemove",function(m){m.preventDefault();m.stopPropagation();b.applyShift(-t,-r);r=t=0;var d=v.getCursorPosition().clientX,h=v.getCursorPosition().clientY,n=[0,0,d-e,h-l],h=d=0,q;q=b.supportsCtrlShift&&m.shiftKey;var p=b.supportsCtrlShift&&A.isCtrl(m);c.changeWVector&&c.changeHVector&&q&&(q=g.normalizeVector(c.vector),n=g.calcDotProduct(n,q),n=[0,0,q[2]*n,q[3]*n]);b.onSnapped(null);c.changeWVector&&(d=g.calcAngleBetweenVectors(c.changeWVector,n),d=g.calcVectorLength(n)*Math.cos(d)||
0);c.changeHVector&&(h=g.calcAngleBetweenVectors(c.changeHVector,n),h=g.calcVectorLength(n)*Math.cos(h)||0);d=d&&u._restricVectorDelta(d,c.changeWVector,b);h=h&&u._restricVectorDelta(h,c.changeHVector,b);n=d&&u._snapVectorDelta(d,c.calcBoundaryWVectors(a,f,h),b);q=h&&u._snapVectorDelta(h,c.calcBoundaryHVectors(a,f,d),b);n&&n.canSnap&&q&&q.canSnap&&(n.canSnap=Math.abs(n.minDelta)<=Math.abs(q.minDelta),q.canSnap=Math.abs(q.minDelta)<Math.abs(n.minDelta));n&&n.canSnap&&(b.onSnapped(n.snapInfo),d=n.snappedDelta);
q&&q.canSnap&&(b.onSnapped(q.snapInfo),h=q.snappedDelta);p&&(d*=2,h*=2);k||!d&&!h||(b.onPreChange(),k=!0);n=d||h;q=a+d;var w=f+h;n&&(p?(t=a/2-q/2,r=f/2-w/2):(p=c.calcOppositePoint(q,w),t=c.oppositePoint[0]-p[0],r=c.oppositePoint[1]-p[1]),b.applyShift(t,r),b.setWidth(q),b.setHeight(w));n&&b.onSizeChanged(m);d&&b.onWidthChanged(m);h&&b.onHeightChanged(m)}),p=x.once(document.body,"mouseup, click",function(a){a.preventDefault();a.stopPropagation();p.remove();m.remove();b.onEnd()})},_getSizerInfo:function(b){function c(a,
f){var b,c,m,p,l,d;switch(k){case "e":b=[a,f/2];c=m=[0,f/2];l=[[0,0,a,0],[0,f,a,f]];break;case "se":b=[a,f];c=[0,0];m=[0,f];p=[a,0];l=[[0,f,a,f],[0,0,a,0]];d=[[a,0,a,f],[0,0,0,f]];break;case "s":b=[a/2,f];c=p=[a/2,0];d=[[0,0,0,f],[a,0,a,f]];break;case "sw":b=[0,f];c=[a,0];m=[a,f];p=[0,0];l=[[a,f,0,f],[a,0,0,0]];d=[[0,0,0,f],[a,0,a,f]];break;case "w":b=[0,f/2];c=m=[a,f/2];l=[[a,0,0,0],[a,f,0,f]];break;case "nw":b=[0,0];c=[a,f];m=[a,0];p=[0,f];l=[[a,0,0,0],[a,f,0,f]];d=[[0,f,0,0],[a,f,a,0]];break;case "n":b=
[a/2,0];c=p=[a/2,f];d=[[0,f,0,0],[a,f,a,0]];break;case "ne":b=[a,0],c=[0,f],m=[0,0],p=[a,f],l=[[0,0,a,0],[0,f,a,f]],d=[[a,f,a,0],[0,f,0,0]]}var h=[a/2,f/2];b=g.rotatePointAroundPoint(h,b,e);c=g.rotatePointAroundPoint(h,c,e);m=m&&g.rotatePointAroundPoint(h,m,e);p=p&&g.rotatePointAroundPoint(h,p,e);a=[c[0],c[1],b[0],b[1]];m=m&&[m[0],m[1],b[0],b[1]];p=p&&[p[0],p[1],b[0],b[1]];l=l&&l.map(function(a){return g.rotateVectorAroundPoint(a,h,e)});d=d&&d.map(function(a){return g.rotateVectorAroundPoint(a,h,
e)});return{sizerPoint:b,oppositePoint:c,vector:a,changeWVector:m,changeHVector:p,boundaryWVectors:l,boundaryHVectors:d}}var k=b.dir,e=b.angle,l=c(b.w,b.h);return{oppositePoint:l.oppositePoint,vector:l.vector,changeWVector:l.changeWVector,changeHVector:l.changeHVector,calcOppositePoint:function(a,b){return c(a,b).oppositePoint},calcBoundaryWVectors:function(a,b,e){a=c(a,b).boundaryWVectors;e&&(e=g.addLengthToVector(g.normalizeVector(l.changeHVector),e),a[0]=g.addPointToVector(a[0],[e[2],e[3]]));return a},
calcBoundaryHVectors:function(a,b,e){a=c(a,b).boundaryHVectors;e&&(e=g.addLengthToVector(g.normalizeVector(l.changeWVector),e),a[0]=g.addPointToVector(a[0],[e[2],e[3]]));return a}}},_restricVectorDelta:function(b,c,k){var e=k.getRestrictNodeBox();if(!e||0>=b||!b)return b;k=k.getThisBox();var l=g.calcVectorLength(c);c=g.addLengthToVector(c,b);c=g.addPointToVector(c,[k.x,k.y]);var a=[e.x+e.w,e.y,e.x+e.w,e.y+e.h],f=[e.x,e.y,e.x+e.w,e.y];b=[e.x,e.y+e.h,e.x+e.w,e.y+e.h];e=g.intersect2Lines(c,[e.x,e.y,
e.x,e.y+e.h]);a=g.intersect2Lines(c,a);f=g.intersect2Lines(c,f);b=g.intersect2Lines(c,b);var t=g.calcVectorLength(c),r=c;[e,a,f,b].forEach(function(a){if(a&&(a=[c[0],c[1],a[0],a[1]],0<g.calcDotProduct(c,a))){var b=g.calcVectorLength(a);b<t&&(t=b,r=a)}});r=g.subtractPointFromVector(r,[k.x,k.y]);return g.calcVectorLength(r)-l},_snapVectorDelta:function(b,c,k){var e=k.getSnapNodeBoxes()||[];if(!e.length||!b)return b;var l=k.getThisBox(),a,f,t,r=Infinity;c.forEach(function(c){c=g.addLengthToVector(c,
b);c=g.addPointToVector(c,[l.x,l.y]);var k=g.calcVectorLength(c);e.forEach(function(b){var d=b.box,e=b.tolerance;[[d.x,d.y,d.x,d.y+d.h],[d.x+d.w,d.y,d.x+d.w,d.y+d.h],[d.x+d.w/2,d.y,d.x+d.w/2,d.y+d.h],[d.x,d.y,d.x+d.w,d.y],[d.x,d.y+d.h,d.x+d.w,d.y+d.h],[d.x,d.y+d.h/2,d.x+d.w,d.y+d.h/2]].forEach(function(b,l){var h=g.intersect2Lines(c,b);h&&(h=[c[0],c[1],h[0],h[1]],0<g.calcDotProduct(c,h)&&(h=g.calcVectorLength(h)-k,Math.abs(h)<=Math.abs(r)&&Math.abs(h)<=e&&(r=h,a=b,t=d,f=2<l)))})})});return{canSnap:!!a,
snapInfo:a&&{elementBox:k.getThisFullBox(),snapBox:t,to:f?a[1]:a[0],isHorizontal:f},minDelta:a?r:NaN,snappedDelta:a?b+r:NaN}},positionSizer:function(b){var c,k,e=b.sizer;e.style.display="block";var l=b.dir,a=b.w,f=b.h;b=b.angle;var t=e.offsetWidth||12,r=e.offsetHeight||12;switch(l){case "e":c=a;k=f/2;break;case "se":c=a;k=f;break;case "s":c=a/2;k=f;break;case "sw":c=0;k=f;break;case "w":c=0;k=f/2;break;case "nw":k=c=0;break;case "n":c=a/2;k=0;break;case "ne":c=a,k=0}b&&(k=g.rotatePointAroundPoint({x:a/
2,y:f/2},{x:c,y:k},b),c=k.x,k=k.y);z.set(e,{left:c-t/2+"px",top:k-r/2+"px",cursor:u._getCursorDirection(l,b)+"-resize"});if("w"===l||"e"===l)y[30>f?"hide":"show"](e);if("s"===l||"n"===l)y[30>a?"hide":"show"](e);e.style.display=""},_getCursorDirection:function(b,c){if(!c)return b;c=g.angleTo0_360Range(c);c=Math.round(c/45);b=u.ALL_DIRECTIONS.indexOf(b)+c;return u.ALL_DIRECTIONS[b%u.ALL_DIRECTIONS.length]}};return u});