// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/geoenrichment/ReportPlayer/core/templates/PaginatableTableInfographic.html":'\x3cdiv class\x3d"esriGEPaginatableTableInfographic"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noDataPlaceHolder" class\x3d"esriGENoDataPlaceHolder"\x3e\r\n        \x3cdiv class\x3d"paginatableTableInfographic_noDataPlaceHolderImage"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"noDataPlaceHolderLabel" class\x3d"esriGENoDataPlaceHolderLabel"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"dataDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"titleDiv" class\x3d"paginatableTableInfographic_titleDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"paginationDiv" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"pageNavigatorDiv" class\x3d"paginatableTableInfographic_pageNavigatorDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"footnoteDiv" class\x3d"paginatableTableInfographic_footNoteDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n\r\n'}});
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/paginatableTable/PaginatableTableInfographic","dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when dojox/uuid/generateRandomUuid dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/geoenrichment/Pagination esri/dijit/geoenrichment/PageNavigator ../../supportClasses/ViewModes ../../supportClasses/tableJson/TableJsonUtil ../../supportClasses/tableJson/TablePrettyParameters ../../sections/supportClasses/SectionContentFitModes ../utils/InfographicThemeUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/ObjectUtil dojo/text!../../templates/PaginatableTableInfographic.html".split(" "),
function(g,h,m,u,n,p,v,w,x,y,k,z,q,r,A,l,B,t,C){g=g([v,w],{templateString:C,viewModel:null,theme:null,parentWidget:null,currentFeatureIndex:null,isEditMode:!1,minRowHeight:40,maxBulletsLimit:5,hasResizableColumns:!0,allowSorting:!0,noDataText:null,hideElementsIfEmpty:!0,canShowEmptyView:!0,pagination:null,pageNavigator:null,_titleSection:null,_sections:null,_currentInfographicJson:null,_isSinglePage:!1,_sectionJsons:null,_columnWidths:null,postCreate:function(){this.inherited(arguments);this._showEmptyView(!1);
this._sections=[];this._createPagination();this._createPageNavigator()},_createPagination:function(){var a=this;this.pagination=(new x({createItemContainer:h.hitch(this,this._createItemContainer),scrollAnimation:"slide",cyclicPagination:!1,autoCenter:"stretch:1,1",detachChildrenUponHiding:!0,onPageChanged:function(){a.pageNavigator.setCurrentPageIndex(a.pagination.get("currentPage"))},onNodePlaced:function(b,d){a._updateItemContainer(b,d)}})).placeAt(this.paginationDiv);this.own(this.pagination);
this.pagination.set("items",[]);this.pagination.startup()},_createPageNavigator:function(){var a=this;this.pageNavigator=(new y({showArrows:!1,getNumPages:function(){return a.pagination.get("items").length},onPageChanged:function(b){a.pagination.set("currentPage",b)}})).placeAt(this.pageNavigatorDiv);this.own(this.pageNavigator)},_createItemContainer:function(){var a=p.create("div",{"class":"paginatableTableInfographic_paginationRoot"});a.style.width=this._getPageWidth()+"px";a.style.height=this._getPageHeight()+
"px";return a},_updateItemContainer:function(a,b){var d=this,e;if(a&&a.parentNode){p.empty(a);var c=this._getSectionByJson(b);if(c&&c.domNode)c.placeAt(a),this._columnWidths&&(e=c.getTables()[0],this._columnWidths.forEach(function(a,b){e.columns[b].style.width=a}),e.refresh());else{c&&c.destroy();var f={};f.initialWidth=this._getPageWidth();f.initialHeight=this._getPageHeight();f.json=b;f.viewModel=this.viewModel;f.theme=this.theme;f.parentWidget=this;f.noContentOffset=!0;f.tableParams={allowSorting:this.allowSorting,
trimTextIfOverflows:!0,autoDetectUrl:!0,keepGridWidthWhenResized:!0,hasResizableColumns:this.hasResizableColumns,disableResizableColumnsAutoDetection:!this.hasResizableColumns,fitParentWhenResized:!0,enableAsyncRendering:!this.isEditMode,asyncBatchSize:b.stack[0].data.columns.length,layoutDefaults:{columnMinWidth:q.MIN_COLUMN_WIDTH},onColumnWidthChanged:function(){d._columnWidths=e&&e.columns.map(function(a){return a.style.width});d._onColumnWidthsChanged()}};f.initialViewMode=this.isEditMode?k.EDIT:
k.PREVIEW_VALUES;h.mixin(f,this._prepareSectionCreationParams(f));this._columnWidths&&this._columnWidths.forEach(function(a,c){b.stack[0].data.columns[c].style.width=a});c=this.viewModel.layoutBuilder.createElement("section",f,a);this._sections.push(c);this._putSectionToHash(c,b);e=c.getTables()[0];m(e.getRenderPromise(),function(){e.domNode&&(d._resizeSection(c),e.onSortingChanged=function(a){d._setSorting(a)},d._sorting&&e.setSorting(d._sorting,{doNotRefresh:!0}))})}return c}},_onColumnWidthsChanged:function(){},
_resizeSection:function(a){if(this._currentInfographicJson.scaleToFitHeight){var b=0,d=a.getTables();d.forEach(function(a){b+=a.store.data.length});d.forEach(function(a,c){c=a.store.data.length;var d=c/b;c=Math.max(this._getPageHeight()*d,c*this.minRowHeight);a.resizeToFitHeight(c,!1)},this)}this._adjustTablesVertically(a);a.fitContentNicely({fitMode:r.WIDTH})},_adjustTablesVertically:function(a){var b=0;a.getTables().forEach(function(a,e){0<e&&a.setPosition(void 0,b);b+=a.domNode.clientHeight},this)},
_prepareSectionCreationParams:function(a){return null},_getPageWidth:function(){return this.width},_getPageHeight:function(){return this.height-this._getTitleHeight()-this._getFooterHeight()},_getTitleHeight:function(){return this._currentInfographicJson.titleSectionJson?z.getTableHeight(this._currentInfographicJson.titleSectionJson.stack[0])+q.TITLE_GAP:0},hasTitle:function(){return 0<this._getTitleHeight()},_getFooterHeight:function(){return this._isSinglePage?0:30},_sectionsHash:null,_getSectionByJson:function(a){this._sectionsHash=
this._sectionsHash||{};a._idInPagination||(a._idInPagination=u());return this._sectionsHash[a._idInPagination]},_putSectionToHash:function(a,b){this._sectionsHash&&(this._sectionsHash[b._idInPagination]=a)},_updatePromise:null,updateInfographic:function(a){if(this.domNode)return this._currentInfographicJson=a,this._updateInfographicJsonTheme(),this._currentInfographicJson.style.backgroundColor&&(this.domNode.style.backgroundColor=this._currentInfographicJson.style.backgroundColor),this.onContentLoadingStart(),
this._updateContent(),this.onShowWaiting(this._updatePromise),this._updatePromise["finally"](function(){this.onContentLoadingEnd()}.bind(this)),this._updatePromise},_updateInfographicJsonTheme:function(){var a=this.viewModel.getStaticInfographicDefaultStyles(this.theme);A.applyThemeSettingsPaginatableInfographicJson(this._currentInfographicJson,a)},getUpdatePromise:function(){return this._updatePromise},_updateContent:function(){return this._updatePromise=B.invoke(this,"_doUpdateContent",50)},_doUpdateContent:function(){if(this.domNode&&
this.width)return this._destroySections(),m(this._buildSectionJsonsAndStat(),function(a){this._showEmptyView(!1);this._sectionJsons=a&&a.sectionJsons;if(!this._sectionJsons||!this._sectionJsons.length)if(!this.hideElementsIfEmpty&&a&&a.unitedSectionJson){var b=h.clone(a.unitedSectionJson);this._currentInfographicJson.scaleToFitHeight&&(b.stack[0].data.data[0].style.height=this.minRowHeight);this._sectionJsons=a.sectionJsons=[b];this._showEmptyView(!0,this._getTitleHeight()-this._getFooterHeight()+
b.stack[0].data.data[0].style.height);l.show(this.dataDiv)}else a=this._sectionJsons=null,this._showEmptyView(!0);a&&(this._syncJsonDimensions(),this.domNode.style.width=this.width+"px",this.domNode.style.height=this.height+"px",this._isSinglePage=1===a.sectionJsons.length,n[this._isSinglePage?"add":"remove"](this.domNode,"singlePage"),this._renderParts(a));this.onContentUpdated()}.bind(this))},_buildSectionJsonsAndStat:function(){},_renderParts:function(a){this._renderTitleSection();this._renderData(a);
this._renderNavigation(a);this._renderFootNote();n[this.footnoteDiv.innerHTML?"add":"remove"](this.domNode,"hasFootnote")},_renderTitleSection:function(){if(this._currentInfographicJson.titleSectionJson){var a={};a.initialWidth=this._getPageWidth();a.json=this._currentInfographicJson.titleSectionJson;a.viewModel=this.viewModel;a.theme=this.theme;a.parentWidget=this;a.noContentOffset=!0;a.tableParams={trimTextIfOverflows:!0};a.initialViewMode=this.isEditMode?k.EDIT:k.PREVIEW_VALUES;h.mixin(a,this._prepareTitleSectionCreationParams());
this._titleSection=this.viewModel.layoutBuilder.createElement("section",a,this.titleDiv);this._titleSection.fitContentNicely({fitMode:r.WIDTH})}},_prepareTitleSectionCreationParams:function(){return null},_renderData:function(a){this.paginationDiv.style.top=this._getTitleHeight()?this._getTitleHeight()+"px":"";this.paginationDiv.style.bottom=this._getFooterHeight()?this._getFooterHeight()+"px":"";this.pagination.set("items",a.sectionJsons);this.pagination.resize()},_renderNavigation:function(a){this.pageNavigator.showAsBullets(a.sectionJsons.length<=
this.maxBulletsLimit);this.pageNavigator.reset();this.pageNavigator.currentPageLabel.style.color=this.viewModel.getDocumentDefaultStyles(this.theme).color},_renderFootNote:function(){},_emptyPlaceholderTopOffset:0,_showEmptyView:function(a,b){this.canShowEmptyView&&(this._emptyPlaceholderTopOffset=b||0,l[a?"hide":"show"](this.dataDiv),l[a?"show":"hide"](this.noDataPlaceHolder),a&&this._syncEmptyViewPlaceholder(),a&&setTimeout(this._syncEmptyViewPlaceholder.bind(this)))},_syncEmptyViewPlaceholder:function(){this.noDataPlaceHolder&&
(this.noDataPlaceHolderLabel.innerHTML=this.noDataText,this.noDataPlaceHolder.style.marginTop=this._emptyPlaceholderTopOffset/2+(this.height-this.noDataPlaceHolder.clientHeight)/2+"px")},_sorting:null,_setSorting:function(a){this._sorting=a;return this._updateContent()},notifyShown:function(){this._sections.forEach(function(a){a.notifyShown()})},width:null,height:null,resize:function(a,b){void 0!==a&&(this.width=a,this.height=b);return this._checkNeedResize()&&this._updateContent()},_checkNeedResize:function(){return this._currentInfographicJson&&
this.width&&this.height&&(!t.compareEqual(this._currentInfographicJson.style.width,this.width,1)||!t.compareEqual(this._currentInfographicJson.style.height,this.height,1))},_syncJsonDimensions:function(){this._currentInfographicJson.style=this._currentInfographicJson.style||{};this._currentInfographicJson.style.width=this.width;this._currentInfographicJson.style.height=this.height},toJson:function(){return h.clone(this._currentInfographicJson)},onContentLoadingStart:function(){},onContentLoadingEnd:function(){},
onContentUpdated:function(){},onShowWaiting:function(a){},_destroySections:function(){this._titleSection&&this._titleSection.destroy();this._titleSection=null;this._sections.forEach(function(a){a.destroy()});this._sections.length=0},destroy:function(){this._destroySections();this.inherited(arguments)}});g.MIN_ROW_HEIGHT=40;g.BOTTOM_AREA_HEIGHT=30;return g});