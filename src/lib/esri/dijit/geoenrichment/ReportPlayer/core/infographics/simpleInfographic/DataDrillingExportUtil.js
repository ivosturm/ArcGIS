// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/DataDrillingExportUtil","dojo/_base/lang esri/dijit/geoenrichment/when dojo/dom-construct esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands ../../reportContainerGrid/utils/PageQueryUtil ../../supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/WaitingUtil".split(" "),
function(n,k,f,p,q,r,t,d,l,u,v,h,w){var e={reportPlayerClass:p,dataProviderClass:t,initPlayer:function(){var a=f.create("div",{"class":"esriGEAbsoluteStretched esriGEOffscreen"},document.body),b=new e.dataProviderClass;b.registerCommand(d.PRINT);b.registerCommand(d.IMAGE);b=(new e.reportPlayerClass({theme:r.DARK,dataProvider:b,resizeMode:q.FIT_WINDOW,isDataDrillingPlayer:!0})).placeAt(a);b.__playerDiv=a;return b},destroyPlayer:function(a){a.destroy();f.destroy(a.__playerDiv)}},b={},m=!1;b.setReportPlayerClass=
function(a){e.reportPlayerClass=a};b.setDataProviderClass=function(a){e.dataProviderClass=a};b.canPrintDataDrilling=function(a){return h.isMobileDevice()?!1:!!l.getParentReportPlayer(a).dataProvider.getCommandById(d.PRINT)};b.canExportDataDrilling=function(a){return h.isMobileDevice()?!1:(a=l.getParentReportPlayer(a).dataProvider.getCommandById(d.IMAGE))&&a.isBrowserSupported()};b.printDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,!0)};b.exportDataDrilling=function(a){b._createTemporaryPlayerAndExport(a,
!1)};b._createTemporaryPlayerAndExport=function(a,d){if(!m){m=!0;var f,g=l.getParentReportPlayer(a),h=g.getReportData(),g=g.dataProvider.reportDataToSingleAreaReportData(h,{currentFeatureIndex:a.currentFeatureIndex||0,reportTitle:g.getReportTitle(),templateJson:function(){var b=a._getDataDrillingPanelDimensions(),b=u.createBlankTemplate({elementWidth:b.w,elementHeight:b.h,layout:{numRows:1,numColumns:1}});b.theme=n.clone(a.theme);delete b.theme.document.backgroundImage;f=a._drillingSections[0].getVisualState();
var c=a._drillingSections[0].toJson(),c=v.createFieldInfoFromSection(c),d=b.sectionsTables[0].data;d.data[0].fieldInfos[d.columns[0].field]=c;return b}()}),c=e.initPlayer();c.onWaitingShown=function(b){w.showProgressPromise(a.dataDrillingViewDiv,b)};c.onCommandSettingsShown=function(a){b.unitTesting_onCommandSettingsShown()};k(c.setReportData(g,{waitUntilAllContentIsReady:!0,disableAnimation:!0}),function(){var a={pages:[{cells:[f]}]};return k(c.onWaitingShown(c.getCurrentReportContainer().setVisualState(a)),
function(){return k(c[d?"executePrint":"executeExport"](),function(a){e.destroyPlayer(c);b.unitTesting_onExportCommandFinished(a)})})})["finally"](function(){m=!1})}};b.unitTesting_onCommandSettingsShown=function(){};b.unitTesting_onExportCommandFinished=function(a){};return b});