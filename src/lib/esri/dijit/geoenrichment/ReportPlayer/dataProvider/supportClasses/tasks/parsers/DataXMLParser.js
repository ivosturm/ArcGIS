// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/DataXMLParser",["esri/dijit/geoenrichment/utils/JsonXmlConverter","../../data/AreaDataUtil","./AttrUtil","esri/dijit/geoenrichment/ReportPlayer/_devConfig"],function(b,n,p,q){var t={parseSchema:function(a){var f={};a.tags.forEach(function(a){"xs:element"===a.name&&a.attributes&&"ReportData"===a.attributes.name&&b.queryJson(a,"xs:element").filter(function(a){return!!a.tags}).forEach(function(a){var h=f[a.attributes.name]=
{};b.queryJson(a,"xs:element").forEach(function(a){h[a.attributes.name]="xs:string"===a.attributes.type?"string":"number"})})});return f}};return{parse:function(a,f){return this._parseDataXmlJson(b.parseXml(a,{saveInnerHTML:!0}),f)},_parseDataXmlJson:function(a,f){function b(a){function b(a){if(a=function(a){var b={},e,g,l;a.tags.forEach(function(d){var c;c=d.innerHTML?d.innerHTML:d.tags&&d.tags.length&&d.tags[0].text||"";var k=c;"string"===m[a.name][d.name]?c=String(c):(c=Number(c),isNaN(c)&&(c=
k),q.emulateErrors.createReportNaN&&(c=NaN));f&&(c=f(d.name,c));b[d.name]||(b[d.name]=c);"AREA_ID"===d.name&&(e=c);"IDFNDFIELD"===d.name&&(g=c);"STORE_ID"===d.name&&(l=c)});e=e||g;if(!e&&!l)return null;var k;!e&&l&&(k=Number(l));e&&void 0===h[e]&&(h[e]=r++);p.cleanUpAttrs(b);return{name:a.name,attrs:b,areaIndex:void 0!==k?k:h[e]}}(a)){var b=g[a.areaIndex]=g[a.areaIndex]||{};b[a.name]?b[a.name].comparisonLevels.push(a.attrs):b[a.name]=n.createCalculator(a.attrs)}}var m;a.tags[0].tags.forEach(function(a){"xs:schema"===
a.name?m=t.parseSchema(a):b(a)})}if(!a||!a.tags||2>a.tags.length)return[];var g=[],h={},r=0;a.tags.forEach(function(a){"ReportData"===a.name&&b(a)});console.log("DataXMLPareser.js \x3d\x3e areaData:");console.log(g);return g}}});