// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/playerSupports/_CommandSupport","dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(k,l,h,f,g,m,n){return k(null,{_initCommands:function(){n.isMobileDevice()||!m.modules.exportCommands?this.playerToolbar.notifyCommandButtonsAdded():f(this.dataProvider.getCommands&&
this.dataProvider.getCommands(),function(a){this._createCommandButtons(a);this.playerToolbar.notifyCommandButtonsAdded()}.bind(this))},_lastNonPrintCommandId:null,_executeExportCallback:null,_executePrintCallback:null,_createCommandButtons:function(a){function b(a){var b=new h,d=new h;c.onCommandSettingsShown(b.promise);c._saveVisualState();f(c._getPrintableContainer({commandId:a,showDialog:!0}),function(a){if(a){var b=a.getSelectedCommandId();b&&b!==g.PRINT&&(c._lastNonPrintCommandId=b);f(c._executeCommand(b,
{printableContainer:a}),d.resolve,d.reject)}else f(c._applySavedVisualState(),function(){c.onCommandCanceled();d.resolve()})}).always(b.resolve);return d.promise}var c=this;if(a&&a.length){var d,e=a.filter(function(a){return a.id===g.PRINT?(d=a,!1):!0});e.length&&(this._executeExportCallback=function(){return b(c._lastNonPrintCommandId||e[0].id)},this._createCommandButton(e[0],this._executeExportCallback));d&&(this._executePrintCallback=function(){return b(d.id)},this._createCommandButton(d,this._executePrintCallback))}},
executeExport:function(){return this._executeExportCallback&&this._executeExportCallback()},executePrint:function(){return this._executePrintCallback&&this._executePrintCallback()},_createCommandButton:function(a,b){return this.playerToolbar.createCommandButton(a,b)},getCommandExportDialogSettings:function(){return this._getPrintDialogSettings()},executeCommand:function(a,b){this._saveVisualState();var c=this;return f(this._getPrintableContainer({commandId:a,showDialog:!1,exportSettings:b&&b.exportSettings}),
function(d){return c._executeCommand(a,l.mixin({printableContainer:d},b))})},_executeCommand:function(a,b){var c=this;a!==g.PDF&&a!==g.DYNAMIC_HTML||!this._viewModel.dynamicReportInfo.fieldData.runReportTaskIDs||(b.creditsTaskIDs=this._viewModel.dynamicReportInfo.fieldData.runReportTaskIDs);var d=new h;setTimeout(function(){f(c.dataProvider.executeCommand&&c.dataProvider.executeCommand(a,c,b,function(a){c.onCommandProgress(a)}),d.resolve,d.reject)});var e=d.promise.then(function(a){return f(c._applySavedVisualState(),
function(){return a})});this.onCommandStart(e,a);this._showWaiting(e);e.always(function(){c.onCommandEnd(e)});return e},_visualStateMemo:null,_saveVisualState:function(){this._visualStateMemo=this.getVisualState()},_applySavedVisualState:function(){var a=this;return this.setVisualState(this._visualStateMemo).then(function(){a._visualStateMemo=null})},onCommandSettingsShown:function(a){},onCommandCanceled:function(){},onCommandStart:function(a,b){},onCommandProgress:function(a){},onCommandEnd:function(a){}})});