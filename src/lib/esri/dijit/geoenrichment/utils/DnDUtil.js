// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/DnDUtil",["dojo/on","dojo/sniff","./DeviceUtil","./KeyboardUtil"],function(c,q,r,u){var l={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,addNoDragClickHandler:function(a,c,b){b=b||{};return r.isMobileDevice()?l._addMobile(a,c,b):l._addPC(a,c,b)},_addPC:function(a,m,b){var g=b.tolerance||0,h,d,e=c(a,"mousedown",function(a){d&&d.remove();var b=a.clientX,e=a.clientY,k;h=c(document.body,"mousemove",function(a){if(!a.shiftKey&&!u.isCtrl(a)){var c=a.clientY;if(0<Math.abs(a.clientX-
b)||0<Math.abs(c-e))k=!0}});d=c.once(document.body,"mouseup",function(a){h.remove();var c=a.clientX,d=a.clientY;!k&&Math.abs(c-b)<=g&&Math.abs(d-e)<=g&&m(a)})});return{remove:function(){h&&h.remove();d&&d.remove();e&&e.remove()}}},_addMobile:function(a,m,b){function g(){e&&e.remove();n&&n.remove();p&&p.remove();clearTimeout(v)}var h=b.tolerance||l.MOBILE_TOLERANCE,d,e,n,p,v;d=c(a,"touchstart",function(d){function k(a){return Math.abs(d.clientX-a.clientX)<h&&Math.abs(d.clientY-a.clientY)<h}g();var f;
if(b.detectLongPress){var w;n=c(a,"touchmove",function(a){w=a});v=setTimeout(function(){k(w||d)&&(b.ignoreReleaseIfLongPressHappened&&(f=!0),b.longPressCallback(d))},b.longPressTimeout||l.LONG_PRESS_TIMEOUT)}e=c.once(a,"touchend",function(a){!f&&k(a)&&m(a);g()});p=c.once(a,"touchcancel",g)});return{remove:function(){d&&d.remove();g()}}},addGlobalDragHanlder:function(a){function m(){b&&b.remove();g&&g.remove();h&&h.remove();d&&d.remove();e&&a.destroyDnDBox&&a.destroyDnDBox(e)}a.tolerance=0<a.tolerance?
a.tolerance:5;var b,g,h,d,e;return c(a.node,a.downEventName||r.press,function(n){m();if(!a.onMouseDown||a.onMouseDown(n)){var p=n.clientX,l=n.clientY,k=p,t=l;b=c(document.body,r.move,function(f){f.shiftKey||u.isCtrl(f)||!(Math.abs(p-f.clientX)>=a.tolerance||Math.abs(l-f.clientY)>=a.tolerance)||(b.remove(),a.dragStarted&&!a.dragStarted(f,f.clientX-k,f.clientY-t))||(k=f.clientX,t=f.clientY,e=a.createDnDBox&&a.createDnDBox(),g=c(document.body,r.move,function(b){a.dragMoved&&a.dragMoved(b,b.clientX-k,
b.clientY-t);k=b.clientX;t=b.clientY}),h=c.once(document.body,q("ie")||q("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){m();a.dragEnded&&a.dragEnded()}),d=c(document.body,"keyup",function(b){27==b.keyCode&&(m(),a.dragCanceled&&a.dragCanceled())}))});c.once(document.body,q("ie")||q("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){b.remove()})}})}};return l});