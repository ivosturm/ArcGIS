// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
(function(B){function y(a,b){var e=a.length;if(3>e)return 0;b||(b=a[0]);var d=b[0];b=b[1];for(var f=a[e-1],e=f[0]-d,g=f[1]-b,c=0,h=0,k=a.length;h<k;h++)var f=a[h],t=f[0]-d,f=f[1]-b,c=c+(t*g-e*f),e=t,g=f;return c/2}var l={};l.calculateRingArea=y;l.calculateRingCentroid=function(a,b){var e=a.length;if(!e)return null;b||(b=a[0]);var d=b[0];b=b[1];var f=0,g=0,c=0;if(2<e)for(var h=a[e-1],e=h[0]-d,k=h[1]-b,t=0,n=a.length;t<n;t++)var h=a[t],m=h[0]-d,h=h[1]-b,l=m*k-e*h,f=f+l,g=g+(e+m)*l,c=c+(k+h)*l,e=m,k=
h;0==f?g=c=0:(g/=3*f,c/=3*f);return[d+g,b+c]};l.INTERIOR=1;l.EXTERIOR=-1;l.BOUNDARY=0;l.createRingInfo=function(a,b){return new C(a,b)};l.createSegmentCoordinates=function(a){return new p(null,0,0,a)};var u=function(a){return function(){for(var b in a){var e=a[b];this[b]="function"===typeof e?e.bind(this):e}a.ctr.bind(this).apply(this,arguments)}},D=u({xmin:null,ymin:null,xmax:null,ymax:null,spatialReference:null,ctr:function(a,b,e,d,f){this.xmin=a;this.ymin=b;this.xmax=e;this.ymax=d;this.spatialReference=
f},printOut:function(){console.log([this.xmin,this.xmax,this.ymin,this.ymax].join(" "))}}),C=u({ring:null,origin:null,area:0,clockwise:!1,extent:null,_coords:null,ctr:function(a,b){this.ring=a;this.origin=b;a=this.ring.length-1;if(!(0>a)){if(!a)a++;else if(this.ring[a][0]!=this.ring[0][0]||this.ring[a][1]!=this.ring[0][1])a++,this.ring.push(this.ring[0].slice());var e=0,d=0;b=!b;this.extent=new D(this.ring[0][0],this.ring[0][1],this.ring[0][0],this.ring[0][1]);for(var f=0;f<a;f++){var g=this.ring[f],
c=g[0];b&&(e+=c);c<this.extent.xmin?this.extent.xmin=c:c>this.extent.xmax&&(this.extent.xmax=c);c=g[1];b&&(d+=c);c<this.extent.ymin?this.extent.ymin=c:c>this.extent.ymax&&(this.extent.ymax=c)}b&&(this.origin=[e/a,d/a]);this.area=y(this.ring,this.origin);0>=this.area?this.area=-this.area:this.clockwise=!0}},setDirection:function(a){this.clockwise==!a&&(this.ring.reverse(),this.clockwise=!this.clockwise,this._coords=null)},testPoint:function(a,b){a=this.getRingCoordinates(b).testPoint(a[0]-this.origin[0],
a[1]-this.origin[1]);return this.clockwise?a:-a},generalize:function(a,b,e){function d(c,d,e){m=c;x=d;if(e||r<n)n=a,v=m-k,w=x-k,r=Math.sqrt(v*v+w*w),r>a*b?(v/=r,w/=r):r=0;n*=b}function f(){if(!r)return!0;var a=g.dx,b=g.dy,c=Math.sqrt(a*a+b*b);return c-a*v-b*w>=.9*c}b=b||.75;var g=this.getRingCoordinates(a),c=g.xs,h=g.ys,k=c[0],l=h[0],n,m,x,v,w,r=0,q=c.length-1;d(c[q],h[q],!0);for(var p=this,u=this.clockwise?function(a){p.ring.splice(a,1)}:function(a){p.ring.splice(-a-1,1)};0<q--&&4<c.length;){var z=
c[q],A=h[q];g.setSegment(k,l,z,A)&&g.testPointOnTouch(m,x,n)&&f()?(c.splice(q+1,1),h.splice(q+1,1),u(q+1),d(z,A)):(k=m,l=x,d(z,A,!0))}this._coords=null;e&&(this.area=y(this.ring,this.origin),this.clockwise||(this.area=-this.area))},getRingCoordinates:function(a,b){if(b)return new p(this.ring,b[0],b[1],a,this.extent,this.clockwise);this._coords&&this._coords.eps==a||(this._coords=new p(this.ring,this.origin[0],this.origin[1],a,this.extent,this.clockwise));return this._coords}});l.RingInfo=C;var p=
u({xs:null,ys:null,extent:null,eps:NaN,dx:null,dy:null,_sx:null,_sy:null,ctr:function(a,b,e,d,f,g){this.xs=[];this.ys=[];a||(a=[]);void 0===b&&(b=0);void 0===e&&(e=0);void 0===d&&(d=0);this.eps=Math.max(d,0);f&&(d=this.eps/2,this.extent=new D(f.xmin-b-d,f.ymin-e-d,f.xmax-b+d,f.ymax-e+d));var c=a.length-1;if(!(0>c))for(f=c?a[c][0]==a[0][0]&&a[c][1]==a[0][1]?c:c+1:1,d=g?1:-1,g=g?0:c;f--;g+=d)c=a[g],this.xs.push(c[0]-b),this.ys.push(c[1]-e)},testPoint:function(a,b){if(!this._pointBelongsToExtent(a,b))return-1;
var e=this.xs.length,d=!1;this.dy=this.ys[0]-this.ys[e-1];if(0==this.dy){for(d=e;1<d--&&(this.dy=this.ys[d]-this.ys[d-1],0==this.dy););if(0==this.dy)return 0}for(var d=0<this.dy,f=0,g=this.xs[0],c=this.ys[0],h,k,l=1;l<=e;l++,g=h,c=k)if(k=l==e?0:l,h=this.xs[k],k=this.ys[k],this.setSegment(g,c,h,k)){var n=c-b,m=k-b,p=!1;0>n&&(n=-n,m=-m,p=!0);if(!(n>this.eps&&m>this.eps)){if(this.testPointOnTouch(a,b,this.eps))return 0;0==n?0!==m&&(0>m&&(d=!d),a<g&&d&&f++):0==m?d=p:0>m&&a<g+this.dx/this.dy*(b-c)&&f++}}return 0!=
f%2?1:-1},testPointOnTouch:function(a,b,e){var d=this.findIntersectionDelta(a,b,a-this.dy,b+this.dx);a=this._sx+d*this.dx-a;b=this._sy+d*this.dy-b;return a*a+b*b<=e*e},_pointBelongsToExtent:function(a,b){return a>=this.extent.xmin&&a<=this.extent.xmax&&b>=this.extent.ymin&&b<=this.extent.ymax},setSegment:function(a,b,e,d){this._sx=a;this.dx=e-a;this._sy=b;this.dy=d-b;return 0!=this.dx||0!=this.dy},findIntersectionDelta:function(a,b,e,d,f){void 0===f&&(f=!0);e-=a;d-=b;var g=this.dy*e-this.dx*d;if(0==
g)return 0;var c=a-this._sx,h=b-this._sy,k=h*e-c*d,c=f?0:h*this.dx-c*this.dy;0>g&&(g=-g,k=-k,c=-c);return f||(c=0>c?0:c<g?c/g:1,this.testPointOnTouch(a+c*e,b+c*d,this.eps))?0>=k?0:k<g?k/g:1:-1},addPointOfSegmentAt:function(a){this.xs.push(this._sx+a*this.dx);this.ys.push(this._sy+a*this.dy)}});l.RingCoordinates=p;B.document?define("esri/dijit/geoenrichment/utils/GeometryUtil_base",function(){return l}):B.GeometryUtil_base=l})(this);