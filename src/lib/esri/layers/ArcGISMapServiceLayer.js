// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/layers/ArcGISMapServiceLayer","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../request ../SpatialReference ../geometry/Extent ./LayerInfo".split(" "),function(c,d,h,k,l,e,m,n,f,p){c=c(null,{declaredClass:"esri.layers.ArcGISMapServiceLayer",infoTemplates:null,constructor:function(a,b){this.layerInfos=[];b&&(this.infoTemplates=b.infoTemplates||null);a=this._params={};if(b=this._url.query?this._url.query.token:null)a.token=b},setInfoTemplates:function(a){this.infoTemplates=
a},_load:function(){m({url:this._url.path,content:d.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler})},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(a,b){try{this._findCredential();(this.credential&&this.credential.ssl||a&&a._ssl)&&this._useSSL();this.description=a.description;this.copyright=a.copyrightText;this.spatialReference=a.spatialReference&&new n(a.spatialReference);this.initialExtent=
a.initialExtent&&new f(a.initialExtent);this.fullExtent=a.fullExtent&&new f(a.fullExtent);this.units=a.units;this.maxRecordCount=a.maxRecordCount;this.maxImageHeight=a.maxImageHeight;this.maxImageWidth=a.maxImageWidth;this.supportsDynamicLayers=a.supportsDynamicLayers;var c=this.layerInfos=[],d=a.layers,g=this._defaultVisibleLayers=[];h.forEach(d,function(a,b){c[b]=new p(a);a.defaultVisibility&&g.push(a.id)});this.visibleLayers||(this.visibleLayers=g);this.version=a.currentVersion;this.cimVersion=
a.cimVersion;this.version||(this.version="capabilities"in a||"tables"in a?10:"supportedImageFormatTypes"in a?9.31:9.3);this.capabilities=a.capabilities;e.isDefined(a.minScale)&&!this._hasMin&&this.setMinScale(a.minScale);e.isDefined(a.maxScale)&&!this._hasMax&&this.setMaxScale(a.maxScale)}catch(q){this._errorHandler(q)}}});k("extend-esri")&&d.setObject("layers.ArcGISMapServiceLayer",c,l);return c});