// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/core/urlUtils",["require","exports","esri/urlUtils","dojo/_base/url"],function(t,c,m,u){function n(a){return m.normalize(a)}function v(a){return"data:"===a.slice(0,5)}function g(a){return p(a)||w.test(a)}function p(a){return a&&"/"===a[0]&&"/"===a[1]}function x(a){return m.urlToObject(a)}function y(a){if("string"===typeof a)return new u(q(a));a.scheme||(a.scheme=c.appUrl.scheme);return a}function z(a){if(v(a))return null;var b=a.indexOf("://");if(-1===b&&p(a))b=2;else if(-1!==
b)b+=3;else return null;b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)}function q(a,b,d){void 0===b&&(b=c.appBaseUrl);if(p(a))return d&&d.preserveProtocolRelative?a:"http"===c.appUrl.scheme&&c.appUrl.authority===z(a).slice(2)?"http:"+a:"https:"+a;if(w.test(a))return a;d=A;if("/"===a[0]){var e=b.indexOf("//"),e=b.indexOf("/",e+2);b=-1===e?b:b.slice(0,e)}return d(b,a)}function B(a,b,d){void 0===d&&(d=!1);a=y(a);b=y(b);return d||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===
b.port:!1}function A(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a&&a.length){b=[];if(g(a[0])){var d=a[0],c=d.indexOf("//");b.push(d.slice(0,c+1));D.test(a[0])&&(b[0]+="/");a[0]=d.slice(c+2)}else"/"===a[0][0]&&b.push("");a=a.reduce(function(a,b){return b?a.concat(b.split("/")):a},[]);for(d=0;d<a.length;d++)c=a[d],".."===c&&0<b.length?b.pop():!c||"."===c&&0!==b.length||b.push(c);return b.join("/")}}function r(a,b,d){if(!(b&&d&&a&&g(a)))return a;var c=a.indexOf("//"),f=a.indexOf("/",
c+2),k=a.indexOf(":",c+2),f=Math.min(0>f?a.length:f,0>k?a.length:k);if(a.slice(c+2,f).toLowerCase()!==b.toLowerCase())return a;b=a.slice(0,c+2);a=a.slice(f);return""+b+d+a}function C(a,b,d){void 0===b&&(b=c.appBaseUrl);if(!g(a))return a;var e=n(a),f=e.toLowerCase();b=n(b).toLowerCase().replace(/\/+$/,"");if((d=d?n(d).toLowerCase().replace(/\/+$/,""):null)&&0!==b.indexOf(d))return a;for(var k=function(a,b,c){c=a.indexOf(b,c);return-1===c?a.length:c},h=k(f,"/",f.indexOf("//")+2),l=-1;f.slice(0,h+1)===
b.slice(0,h)+"/";){l=h+1;if(h===f.length)break;h=k(f,"/",h+1)}if(-1===l||d&&l<d.length)return a;a=e.slice(l);e=b.slice(l-1).replace(/[^/]+/g,"").length;if(0<e)for(f=0;f<e;f++)a="../"+a;else a="./"+a;return a}Object.defineProperty(c,"__esModule",{value:!0});c.normalize=n;c.canUseXhr=function(a){return m.canUseXhr(a)};c.removeTrailingSlash=function(a){return a.replace(/\/+$/,"")};t=Function("return this")();c.appUrl=new u(t.location);c.appBaseUrl=function(){var a=c.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-
1]));return""+(c.appUrl.scheme+"://"+c.appUrl.host+(null!=c.appUrl.port?":"+c.appUrl.port:""))+a}();var D=/^\s*file:/i,w=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;c.isDataProtocol=v;c.isAbsolute=g;c.isProtocolRelative=p;c.urlToObject=x;c.getOrigin=z;c.makeAbsolute=q;c.hasSameOrigin=B;c.join=A;c.removeFile=function(a){var b=0;if(g(a)){var c=a.indexOf("//");-1!==c&&(b=c+2)}c=a.lastIndexOf("/");return c<b?a:a.slice(0,c+1)};c.addProxy=function(a){return m.addProxy(a)};c.makeData=function(a){return a.isBase64?"data:"+
a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};var E=/^data:(.*?)(;base64)?,(.*)$/;c.dataComponents=function(a){return(a=a.match(E))?{mediaType:a[1],isBase64:!!a[2],data:a[3]}:null};c.changeDomain=r;c.read=function(a,b){var d=b&&b.url&&b.url.path;a&&d&&(a=q(a,d,{preserveProtocolRelative:!0}));(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?(d=b.urlKey+"."+b.customBaseUrl,b=B(c.appUrl,c.appUrl.scheme+"://"+d)?r(a,b.portalHostname,d):r(a,d,b.portalHostname)):b=a;return b};c.write=
function(a,b){if(!a)return a;!g(a)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(a);var c=q(a);if(b){var e=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||b.url&&b.url.path;e&&(c=C(c,e,e),c!==a&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(c))}a=c;c=(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?r(a,b.urlKey+"."+b.customBaseUrl,b.portalHostname):a;return c};c.makeRelative=C;c.removeQueryParameters=function(a){a=x(a);Object.keys(a.query||{});return a.path}});