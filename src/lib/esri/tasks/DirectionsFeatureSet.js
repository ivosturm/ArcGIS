// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/tasks/DirectionsFeatureSet","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json ../kernel ../geometry/Extent ../geometry/Polyline ../geometry/Point ../graphic ./FeatureSet".split(" "),function(d,q,l,v,w,x,y,t,z,A,B){d=d(B,{declaredClass:"esri.tasks.DirectionsFeatureSet",constructor:function(a,r){this.routeId=a.routeId;this.routeName=a.routeName;q.mixin(this,a.summary);this.extent=new y(this.envelope);var e=this._fromCompressedGeometry,f=this.features,g=this.extent.spatialReference,
h=[];l.forEach(r,function(a,b){f[b].setGeometry(h[b]=a?e(a,g):f[b].geometry)});this.mergedGeometry=this._mergePolylinesToSinglePath(h,g);this.geometryType="esriGeometryPolyline";l.forEach(a.events,function(p,b){l.forEach(p,function(a,b){p[b]=new A(new z(a.point.x,a.point.y,g),null,{ETA:a.ETA,strings:w.stringify(a.strings),arriveTimeUTC:a.arriveTimeUTC})});a.events[b]=p});delete this.envelope},_fromCompressedGeometry:function(a,r){var e=0,f=0,g=0,h=0,p=[],b,k,d,q,u,c=0,m=0,n=0;(a=a.match(/((\+|\-)[^\+\-\|]+|\|)/g))||
(a=[]);0===parseInt(a[c],32)?(c=2,b=parseInt(a[c],32),c++,d=parseInt(a[c],32),c++,b&1&&(m=l.indexOf(a,"|")+1,q=parseInt(a[m],32),m++),b&2&&(n=l.indexOf(a,"|",m)+1,u=parseInt(a[n],32),n++)):(d=parseInt(a[c],32),c++);for(;c<a.length&&"|"!==a[c];)b=parseInt(a[c],32)+e,c++,e=b,k=parseInt(a[c],32)+f,c++,f=k,b=[b/d,k/d],m&&(k=parseInt(a[m],32)+g,m++,g=k,b.push(k/q)),n&&(k=parseInt(a[n],32)+h,n++,h=k,b.push(k/u)),p.push(b);e=new t({paths:[p],hasZ:0<m,hasM:0<n});e.setSpatialReference(r);return e},_mergePolylinesToSinglePath:function(a,
d){var e=[],f=!1;l.forEach(a,function(a){l.forEach(a.paths,function(b){f=f||a.hasM;e=e.concat(b)})});var g=[],h=[0,0];l.forEach(e,function(a){if(a[0]!==h[0]||a[1]!==h[1])g.push(a),h=a});return new t({paths:[g],spatialReference:d,hasM:f})}});v("extend-esri")&&q.setObject("tasks.DirectionsFeatureSet",d,x);return d});