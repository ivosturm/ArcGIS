// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/RasterFunctionEditor/RFxNamedRasterEditor","dojo/_base/declare dojo/has ../../kernel dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dijit/form/TextBox dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./RFxRasterInput ./utils dojo/i18n!../../nls/jsapi".split(" "),function(g,l,m,n,h,f,k,p,q,r,t,u,v,w){g=g("RFxNamedRasterEditor",[q,r,t],{templateString:"\x3cdiv class\x3d'esriRFxNamedRasterEditor'\x3e\x3ctable data-dojo-attach-point\x3d'rasterInputsTable' class\x3d'esriRFxArgsEditor__table--auto'\x3e\x3ctr\x3e\x3ctd colspan\x3d4\x3e${_i18n.rfxNamedRasterEditor.rasterVariables}\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e\x3c/div\x3e",
schemaArgDefinitions:{},inputArgs:{},rasterArgs:{},rasterFunctionSchema:null,rasterFunctionEnums:null,inputLayers:null,constructor:function(a){this.inherited(arguments);this._i18n=w.widgets.rasterFunctionEditor;this.namedRasterControls=[]},postCreate:function(){this.inherited(arguments);this._readValues()},_readValues:function(){for(var a=this.inputArgs,c=a&&a.InputNames&&a.InputNames.value||[],a=(a=a&&a.Rasters)&&(a.value&&a.value.elements||a.value)||[],b=Math.max(a.length,c.length),d=0;d<b;)this._addRow(c[d],
a[d]),d++;this._addRow()},_addRow:function(a,c){if(this._layerAddRowHandle||this._inputNameAddRowHandle)this._layerAddRowHandle.remove(),this._inputNameAddRowHandle.remove();var b,d,e;b=f.create("tr",null,this.rasterInputsTable);d=f.create("td",{"class":"esriRFxNamedRasterEditor__td--input"},b);f.create("td",{innerHTML:"\x3d","class":"esriRFxNamedRasterEditor__td--assignment"},b);e=f.create("td",null,b);f.create("td",{"class":"esriRFxNamedRaster__td--delete",onclick:this._cleanupVariables.bind(this,
b)},b);d=f.create("div",null,d,"first");e=f.create("div",null,e);a=new p({value:a||""},d);c=new u({inputLayers:this.inputLayers,allowScalar:!0,rfxVariable:c,browseProperties:this.browseProperties,selectDefault:!1},e);a.on("change",this._updateNamedRasters.bind(this));c.on("change",this._updateNamedRasters.bind(this));this.namedRasterControls.push({inputNameControl:a,layerControl:c,parent:b});a.startup();c.startup();this._updateVariablesUI();this._layerAddRowHandle=c.on("change",this._addRow.bind(this,
"",void 0));this._inputNameAddRowHandle=a.on("change",this._addRow.bind(this,"",void 0));this.own(this._layerAddRowHandle);this.own(this._inputNameAddRowHandle);this._updateNamedRasters()},_updateVariablesUI:function(){var a=this.namedRasterControls.length-1;h.forEach(this.namedRasterControls,function(c,b){c&&c.deleteCheckbox&&c.deleteCheckbox.domNode&&(b===a?k.set(c.deleteCheckbox.domNode,"visibility","hidden"):k.set(c.deleteCheckbox.domNode,"visibility","visible"))})},_cleanupVariables:function(a){if(a){var c=
this.namedRasterControls.length-1;h.some(this.namedRasterControls,function(b,d){d!==c&&b&&b.parent===a&&(b.inputNameControl.destroy(),b.layerControl.destroy(),f.destroy(a),this.namedRasterControls[d]=null)},this);this.namedRasterControls=h.filter(this.namedRasterControls,function(a){return a});this._updateNamedRasters()}},_updateNamedRasters:function(){var a=[],c=[],b=this.inputArgs;this.namedRasterControls&&h.forEach(this.namedRasterControls,function(b,e){if(e!==this.namedRasterControls.length-1&&
b){var d=b.layerControl;e=b.layerControl.get("value");b=b.inputNameControl.value;if(e||""!==b)d=v.getArgRFT(d.rfxVariable),c.push(b),d?a.push(this.getRFT(d)):a.push(e)}},this);b&&(b.Rasters&&(b.Rasters.value=a),b.InputNames&&(b.InputNames.value=c))}});l("extend-esri")&&n.setObject("dijit.RasterFunctionEditor.RFxNamedRasterEditor",g,m);return g});