// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/analysis/mixins/browselayers/configs/EnterpriseBrowseItem","dojo/_base/lang dojo/has dojox/lang/functional/object ../../../../../kernel ./Common ../../../AnalysisRegistry ../../../ItemTypes dojo/i18n!../../../nls/BrowseLayerMixin".split(" "),function(g,l,h,m,f,d,c,e){var k={getConfig:function(a){var b=a.disableLAAL?{customSections:[]}:{customSections:f.getLAALCustomSection(a)};!a.disableBoundary&&a.portal.EsriBoundaryLayersGroupQuery&&b.customSections.push(f.getBoundaryLayersSection(a));
-1<a.allowedItemTypes.indexOf(c.RFT)&&b.customSections.push(f.getSystemRFTSection(a));a=g.mixin({dialogTitle:a.title||e.customAnalysisLayerTitle,allowedItemTypes:a.allowedItemTypes,availableItemTypeFilters:a.availableItemTypeFilters,baseSections:["myContent","myFavorites","myGroups","myOrganization"],specialItemQ:this._getSpecialItemFilter(a.allowedItemTypes),resultsPerQuery:f.getNumberOfPages(),layoutMode:"fullscreen",staticFilters:f.getStaticFilters(a.customQueryTags),mainActionTitle:e.mainActionTitle,
customActions:[f.getAddtoMapActions(a.onActionSubLayer),f.getEditRFTActions(a.onEditRFT)],showSubResources:this._getSubResourcesForPortal(a),disabledSubResources:a.disabledSubResources,addQueryParameters:a.addQueryParameters},b);this._isGPService(a.allowedItemTypes)&&(a.allowedItemTypes=this._removeGPService(a.allowedItemTypes));return a},_getSubResourcesForPortal:function(a){var b={};-1<a.allowedItemTypes.indexOf(c.FS)&&(b[c.FS]={allowed:function(b){return this.allowedItemsForTypes(b,a.customQueryTags)}.bind(this),
onSelect:a.onSelectSubLayer,customActions:[f.getAddtoMapActions(a.onActionSubLayer)],filters:this._getFilterforSubLayer(!1,a.customQueryTags)});-1<a.allowedItemTypes.indexOf(c.MS)&&(b[c.MS]={allowed:function(b){return this.allowedItemsForTypes(b,a.customQueryTags)}.bind(this),onSelect:a.onSelectSubLayer,customActions:[f.getAddtoMapActions(a.onActionSubLayer)],filters:this._getFilterforSubLayer(!1,a.customQueryTags)});-1<a.allowedItemTypes.indexOf(c.BIGDATA)&&(b[c.BIGDATA]={allowed:function(b){return this.allowedItemsForTypes(b,
a.customQueryTags)}.bind(this),onSelect:a.onSelectSubLayer,filters:this._getFilterforSubLayer(!0,a.customQueryTags)});-1<a.allowedItemTypes.indexOf(c.GPSERVICE)&&(b[c.GPSERVICE]={allowed:function(){return!0},onSelect:a.onSelectGPTool,filters:[]});return b},_getFilterforSubLayer:function(a,b){var c=[];c.push(this.getGeometryFilter(b.geometryTypes));b.layerTypes&&(a?c.push(this.getFilterForLayerTypesForBigData(b.layerTypes)):c.push(this.getFilterForLayerTypesForFS(b.layerTypes)));b.timeTypes&&c.push(this.getTimeFilter(b.timeTypes));
return c},getGeometryFilter:function(a){var b=[];(a&&0<a.length?a:h.values(d.GeometryTypes)).forEach(function(a){switch(a){case d.GeometryTypes.Point:b.push({displayName:e.pointFilterName,allowed:this.filters.geometryTypes[d.GeometryTypes.Point],value:"point"});break;case d.GeometryTypes.Polygon:b.push({displayName:e.polygonFilterName,allowed:this.filters.geometryTypes[d.GeometryTypes.Polygon],value:"polygon"});break;case d.GeometryTypes.Line:b.push({displayName:e.lineFilterName,allowed:this.filters.geometryTypes[d.GeometryTypes.Line],
value:"line"});break;case d.GeometryTypes.MultiPoint:b.push({displayName:e.multiPointFilterName,allowed:this.filters.geometryTypes[d.GeometryTypes.MultiPoint],value:"multipoint"})}},this);return{allowed:function(){return!0},displayName:e.geometryFilterName,value:"geometry",children:b}},getFilterForLayerTypesForFS:function(a){var b=[];(a?0<a.length?a:[c.FLAYER,c.TABLE]:[]).forEach(function(a){switch(a){case c.FLAYER:b.push({displayName:e.featureLayerName,allowed:this.filters.layerTypes[c.FLAYER],value:"featurelayer"});
break;case c.TABLE:b.push({displayName:e.tableLayerName,allowed:this.filters.layerTypes[c.TABLE],value:"ftable"})}},this);return{allowed:function(){return!0},displayName:e.itemTypeFilterName,value:"itemtype",children:b}},getFilterForLayerTypesForBigData:function(a){var b=[];(a?0<a.length?a:[c.BDATAFEATURE,c.BTABLE]:[]).forEach(function(a){switch(a){case c.BDATAFEATURE:b.push({displayName:e.featureLayerName,allowed:this.filters.layerTypes[c.BDATAFEATURE],value:"bfeaturelayer"});break;case c.BTABLE:b.push({displayName:e.tableLayerName,
allowed:this.filters.layerTypes[c.BTABLE],value:"btable"})}},this);return{allowed:function(){return!0},displayName:e.featureLayerName,value:"itemtype",children:b}},getTimeFilter:function(a){var b=[];(a?0<a.length?a:[d.TimeTypes.Instant,d.TimeTypes.Interval]:[]).forEach(function(a){switch(a){case d.TimeTypes.Instant:b.push({displayName:e.instantFilterName,allowed:this.filters.timeTypes[d.TimeTypes.Instant].bind(this),value:"instant"});break;case d.TimeTypes.Interval:b.push({displayName:e.intervalFilterName,
allowed:this.filters.timeTypes[d.TimeTypes.Interval].bind(this),value:"interval"})}},this);return{allowed:function(){return!0},displayName:e.timeFilterName,value:"time",children:b}},allowedItemsForTypes:function(a,b){var e=!0,f=b.layerTypes||[c.FLAYER,c.BDATAFEATURE];b.geometryTypes&&a.geometryType&&(b.geometryTypes=0<b.geometryTypes.length?b.geometryTypes:h.values(d.GeometryTypes),e=e&&-1!==b.geometryTypes.indexOf(a.geometryType));f&&a.type&&(f=0<f.length?f:[c.FLAYER,c.BDATAFEATURE,c.BTABLE,c.TABLE],
e=e&&-1!==f.indexOf(a.type));b.timeTypes&&(b.timeTypes=0<b.timeTypes.length?b.timeTypes:[d.TimeTypes.Instant,d.TimeTypes.Interval],e=e&&-1!==b.timeTypes.indexOf(this.getTimeType(a)));b.customCheck&&b.customCheck.customCheckHandler&&(e=e&&b.customCheck.customCheckHandler(a));return e&&a},getTimeType:function(a){return a?this.isDefined(a.timeInfo)&&this.isDefined(a.timeInfo.startTimeField)&&!this.isDefined(a.timeInfo.endTimeField)?d.TimeTypes.Instant:this.isDefined(a.timeInfo)&&this.isDefined(a.timeInfo.startTimeField)&&
this.isDefined(a.timeInfo.endTimeField)?d.TimeTypes.Interval:this.isDefined(a.time)&&this.isDefined(a.time.timeType)?a.time.timeType:!1:!1},isDefined:function(a){return void 0!==a&&null!==a},_getSpecialItemFilter:function(a){return this._isGPService(a)?'type:"Geoprocessing Service" AND typekeywords: "Web Tool"':""},_isGPService:function(a){return-1<a.indexOf(c.GPSERVICE)},_removeGPService:function(a){a.splice(a.indexOf(c.GPSERVICE),1);return a},filters:{layerTypes:{"Feature Layer":function(a){return a.type===
c.FLAYER},Table:function(a){return a.type===c.TABLE},featureClass:function(a){return a.type===c.BDATAFEATURE},table:function(a){return a.type===c.BTABLE}},geometryTypes:{esriGeometryMultipoint:function(a){return a.geometryType===d.GeometryTypes.MultiPoint},esriGeometryPolyline:function(a){return a.geometryType===d.GeometryTypes.Line},esriGeometryPolygon:function(a){return a.geometryType===d.GeometryTypes.Polygon},esriGeometryPoint:function(a){return a.geometryType===d.GeometryTypes.Point}},timeTypes:{instant:function(a){return this.getTimeType(a)===
d.TimeTypes.Instant},interval:function(a){return this.getTimeType(a)===d.TimeTypes.Interval}}}};l("extend-esri")&&g.setObject("dijit.analysis.mixins.browselayers.configs.EnterpriseBrowseItem",k,m);return k});