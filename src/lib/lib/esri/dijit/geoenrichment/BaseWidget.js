// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/BaseWidget","esri/declare dojo/_base/lang dojo/Evented dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/string dojo/on dijit/Destroyable dijit/layout/BorderContainer dijit/layout/ContentPane ./utils/ObjectUtil ./infographicUtils/dom ./infographicUtils/formatVariable".split(" "),function(k,g,h,f,n,l,p,q,r,t,u,v,w,m){h=k("esri.dijit.geoenrichment.BaseWidget",h,{data:null,metadata:null,parent:null,dataEvents:null,_state:null,expanded:!0,title:null,titleDiv:null,subtitle:null,
subtitleDiv:null,ui:null,sortTriangles:null,baseClass:null,constructor:function(a){if(!a)throw"Parent HTML element was not specified";this._state={sortBy:0,sortDesc:!1};this.parent=a},setDataProvider:function(a){this._destroyDataEvents();a&&(this.feedData(a),this.dataEvents=new r,this.dataEvents.own(a.on("data",g.hitch(this,this.feedData,a))))},_destroyDataEvents:function(){this.dataEvents&&(this.dataEvents.destroy(),this.dataEvents=null)},feedData:function(a){if(this.data=a.getData())this.metadata=
a.metadata,this.update()},update:function(){this.data&&this._state&&(this.ui||(l.add(this.parent,"WidgetBack"),this.createUIPrivate(),this.baseClass&&l.add(this.ui.domNode,this.baseClass)),this.updateUIPrivate())},createUIPrivate:function(){var a=new x;this.expanded?this.createUIExpanded(a):this.createUICollapsed(a);this.ui=a.build(this.parent)},updateUIPrivate:function(){this.expanded?this.updateUIExpanded():this.updateUICollapsed();this.resize();q.emit(this,"resize",[this.parent.scrollWidth,this.parent.scrollHeight])},
createUI:function(a){this.titleDiv=a.addHeader("div",{"class":"BaseWidget_Title"});this.subtitleDiv=a.addHeader("div",{"class":"BaseWidget_Subtitle"})},createUIExpanded:function(a){this.createUI(a)},createUICollapsed:function(a){this.createUI(a)},updateUIExpanded:function(){this.updateUI()},updateUICollapsed:function(){this.updateUI()},updateUI:function(){if(this.sortTriangles)for(var a in this.sortTriangles)this.sortTriangles[a].innerHTML=this._state.sortBy==+a?this._state.sortDesc?"\x26#9660;":
"\x26#9650;":"";this.title?(this.titleDiv.innerHTML=this.title,this.titleDiv.style.display=""):(this.titleDiv.innerHTML="",this.titleDiv.style.display="none");if(this.subtitle){a={};var b=this.data.features[0].attributes,c=this.metadata,d;for(d in c)c.hasOwnProperty(d)&&(a[d]=b[c[d]]||"");this.subtitleDiv.innerHTML=p.substitute(this.subtitle,a);this.subtitleDiv.style.display=""}else this.subtitleDiv.innerHTML="",this.subtitleDiv.style.display="none"},resize:function(){this.ui&&this.ui.resize()},_appendSortHeader:function(a,
b,c,d){a=a.insertCell(-1);for(var e in d)d.hasOwnProperty(e)&&n.set(a,e,d[e]);b=f.create("span",{"class":"SortLink",innerHTML:b},a);b.onclick=g.hitch(this,this.sortBy,c);w.text(b," ");this.sortTriangles||(this.sortTriangles=[]);this.sortTriangles[c]=f.create("span",{"class":"SortArrow"},b)},sortBy:function(a){this._state.sortDesc=this._state.sortBy==a?!this._state.sortDesc:!1;this._state.sortBy=a;this.updateUIPrivate()},_sortRows:function(a){var b=this._state.sortBy;if(v.isNumber(b)){var c=this._state.sortDesc;
a.sort(function(a,e){a=a[b];e=e[b];e=a>e?c?-1:1:a<e?c?1:-1:0;return e})}},getFeatureTitle:function(a){return this.data.features[a].attributes[this.metadata.name]},getValueByName:function(a,b){return this.data.features[a].attributes[b]},getValueByIndex:function(a,b){return this.getValueByName(a,this.getFieldByIndex(b).name)},formatByName:function(a,b){return m(this.getFieldByName(b),this.data.features[a].attributes[b])},formatByIndex:function(a,b){b=this.getFieldByIndex(b);return m(b,this.data.features[a].attributes[b.name])},
getDataFields:function(){for(var a=[],b=this.data.fields.length,c=0;c<b;c++){var d=this.data.fields[c].fullName;d&&"AREA_ID"!=d&&a.push(c)}return a},getFieldByName:function(a){for(var b=this.data.fields.length,c=0;c<b;c++){var d=this.data.fields[c];if(d.name==a)return d}},getFieldByIndex:function(a){return this.data.fields[a]},setState:function(a){g.mixin(this._state,a)},getState:function(a){return this._state?this._state[a]:null},destroy:function(a){a||this._destroyDataEvents();this.ui&&(this.ui.destroy(),
this.ui=null)}});var x=k(null,{headerClass:null,contentClass:null,footerClass:null,constructor:function(){this.headerClass=["BaseWidget_HeaderPane"];this.contentClass=["BaseWidget_ContentPane"];this.footerClass=["BaseWidget_FooterPane"]},addHeader:function(a,b){this.header||(this.header=document.createDocumentFragment());return f.create(a,b,this.header)},addContent:function(a,b){this.content||(this.content=document.createDocumentFragment());return f.create(a,b,this.content)},addFooter:function(a,
b){this.footer||(this.footer=document.createDocumentFragment());return f.create(a,b,this.footer)},build:function(a){this.border=new t({style:"height: 100%; width: 100%;",gutters:!1});this._append("top",this.header,this.headerClass);this._append("center",this.content,this.contentClass);this._append("bottom",this.footer,this.footerClass);a.appendChild(this.border.domNode);return this.border},_append:function(a,b,c){if(b){var d;c&&0<c.length&&(d=c.join(" "));this.border.addChild(new u({region:a,content:b,
"class":d}))}}});return h});