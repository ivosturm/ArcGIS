// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/LayersSorter",["dojo/_base/declare","./LayerInfoTemplateProvider","esri/dijit/geoenrichment/utils/InvokeUtil"],function(d,e,f){return d(null,{AREA_FEATURE_POINTS:"areaFeaturePoints",LOCATOR_POINTS:"locatorPoints",ADDITIONAL_LAYER_POINTS:"additionalLayerPoints",STD_POLYGON_LABELS:"stdPolygonLabels",AREA_FEATURE_POLYGONS:"areaFeaturePolygons",STD_POLYGONS:"stdPolygons",ADDITIONAL_LAYER_POLYGONS:"additionalLayerPolygons",_map:null,
_infos:null,constructor:function(a){this._map=a;this._infos=[]},registerLayerInfo:function(a){switch(a.type){case this.AREA_FEATURE_POINTS:case this.LOCATOR_POINTS:case this.ADDITIONAL_LAYER_POINTS:case this.STD_POLYGON_LABELS:a.geometryType="esriGeometryPoint";break;case this.AREA_FEATURE_POLYGONS:case this.STD_POLYGONS:case this.ADDITIONAL_LAYER_POLYGONS:a.geometryType="esriGeometryPolygon";break;default:a.geometryType=a.geometryType||("esriGeometryPoint"===a.layer.geometryType?"esriGeometryPoint":
"esriGeometryPolygon")}this._map.removeLayer(a.layer);this._infos.push(a);this.sortLayers()},addFromAdditionalLayerInfos:function(a){var c=this;a&&a.forEach(function(a){c._map.graphicsLayerIds.some(function(b){b=c._map.getLayer(b);if(b.url===a.url&&(!b.renderer||"heatmap"!==b.renderer.type))return e.provideInfoTemplate(b),c.registerLayerInfo({layer:b,type:"esriGeometryPoint"===b.geometryType?c.ADDITIONAL_LAYER_POINTS:c.ADDITIONAL_LAYER_POLYGONS,preferredIndex:a.index}),!0})})},sortLayers:function(){return f.invoke(this,
"_doSortLayers",50)},_doSortLayers:function(){function a(a){if(c._isHeatmapLayer(a))return 0;var b=0;"esriGeometryPoint"===a.geometryType&&(b+=1E6);switch(a.type){case c.STD_POLYGON_LABELS:b+=1E3;break;case c.ADDITIONAL_LAYER_POINTS:b+=2E3;break;case c.LOCATOR_POINTS:b+=3E3;break;case c.AREA_FEATURE_POINTS:b+=4E3;break;case c.ADDITIONAL_LAYER_POLYGONS:b+=1E3;break;case c.STD_POLYGONS:b+=2E3;break;case c.AREA_FEATURE_POLYGONS:b+=3E3}return b+(a.preferredIndex||0)}var c=this;this._infos.sort(function(c,
b){return a(c)-a(b)});this._infos.forEach(function(a,b){c._map.addLayer(a.layer);c._isHeatmapLayer(a)&&a.layer.setRenderer(a.layer.renderer)})},_isHeatmapLayer:function(a){return a.layer.renderer&&("heatmap"===a.layer.renderer.type||"esri.renderer.HeatmapRenderer"===a.layer.renderer.declaredClass)}})});