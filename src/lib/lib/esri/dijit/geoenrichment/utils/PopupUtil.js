// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/PopupUtil","dojo/_base/lang esri/dijit/geoenrichment/utils/onClickTouch dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/when dijit/popup dijit/place ./DeviceUtil ./DnDUtil ./MouseUtil dojo/domReady!".split(" "),function(D,w,E,f,r,x,y,l,t,u,F,z){function G(b){if(!b)return["below"];var d=[];b.forEach(function(b){var c=r.isBodyLtr();switch(b){case "before-alt":c=!c;case "after-alt":d.push(c?{aroundCorner:"BR",corner:"BL"}:
{aroundCorner:"BL",corner:"BR"});d.push(c?{aroundCorner:"TR",corner:"TL"}:{aroundCorner:"TL",corner:"TR"});return}d.push(b)});return d}var k={makePopup:function(b,d,n,c){function t(a){if(c.overlay&&a._popupWrapper){var b=f.create("div",{"class":c.overlay.overlayClass});if(c.overlay.overlayParent)f.place(b,c.overlay.overlayParent);else{f.place(b,g,"before");var e=x.get(a._popupWrapper,"zIndex");x.set(b,"zIndex",e)}a.__popupOverlay=b}}function A(a){a.__popupOverlay&&(f.destroy(a.__popupOverlay),a.__popupOverlay=
null)}function B(a){p=!1;a.__bodyClickHandler&&a.__bodyClickHandler.remove();a.__bodyClickHandler=null;a.__popupWidgetOpenFlag=!1;A(a);c.onClose&&c.onClose()}function h(e){e&&c.stopEventPropagation&&e.stopPropagation();p||(p=!0,y(a||("function"==typeof b?b():b),function(b){a=b;a.domNode?(a.__openPopupWidgetFunc=h,g=l.moveOffScreen(a),y(c.onPreShow&&c.onPreShow(),function(){var b=G(c.orient);if(g&&!1!==c.allowAutoOrientation){var e=-1!==b.indexOf("below"),f=r.position(n),h=r.position(g);e&&f.y+f.h+
h.h>document.body.clientHeight&&(e=!e);b=b.map(function(a){return"below"!=a||e?a:"above"})}c.noOverflow&&(a.baseClass="esriGENoOverflow "+a.baseClass);l.open({parent:d,popup:a,around:n,orient:b,onClose:function(){B(a)}});c.suppressReposition&&clearTimeout(l._aroundMoveListener);c.noOverflow&&(a.baseClass=a.baseClass.replace("esriGENoOverflow ",""));g&&c.wrapperClass&&E.add(g,c.wrapperClass);a.__popupInfo=D.mixin({},l.getTopPopup());a.__popupInfo.orient=b;a.__popupInfo.around=n;A(a);t(a);c.onShow&&
c.onShow();a.__popupWidgetOpenFlag=!0;q&&a.own&&a.own(q);a.__bodyClickHandler&&a.__bodyClickHandler.remove();if(!1!==c.closeOnClickOutside){var m="function"===typeof c.closeOnClickOutside?c.closeOnClickOutside:null;setTimeout(function(){a.__bodyClickHandler&&a.__bodyClickHandler.remove();a.__bodyClickHandler=w(document.body,u.isMobileDevice()?u.press:C,function(b){p&&(z.fixTouchEvent(b),m&&!m(b)||z.isMouseOver(g)||c.isMouseOver&&c.isMouseOver()||a.isMouseOver&&a.isMouseOver()||a.__lockPopupWidgetFlag||
k.close(a))})})}})):p=!1}))}if(b){c=c||{};var C=c.openMouseEvent?c.openMouseEvent:u.clickOrRelease,a="function"!==typeof b?b:null;if(a)var g=l.moveOffScreen(a);var p=!1;a&&(a.__openPopupWidgetFunc=h);var q;if(!1!==c.openOnMouseEvent){var m=h;if(c.toggleOnClick)var v,m=function(b){v=v||b.type;a?v===b.type&&k.toggle(a):h()};q=!1===c.onClickComponent?null:void 0!==c.noDragClickTolerance?F.addNoDragClickHandler(c.onClickComponent||n,m,{tolerance:c.noDragClickTolerance}):w(c.onClickComponent||n,C,m)}c.openPopup&&
h();return{remove:function(){a&&"function"!==typeof a&&(k.close(a),B(a),a._popupWrapper&&(a.domNode&&a.domNode.parentNode===a._popupWrapper&&a._popupWrapper.removeChild(a.domNode),f.destroy(a._popupWrapper),delete a._popupWrapper),delete a.__openPopupWidgetFunc,delete a.__popupWidgetOpenFlag);q&&q.remove()}}}},setLocked:function(b,d){b.__lockPopupWidgetFlag=d},open:function(b){b&&!b.__lockPopupWidgetFlag&&!b.__popupWidgetOpenFlag&&b.__openPopupWidgetFunc&&b.__openPopupWidgetFunc()},close:function(b){b&&
!b.__lockPopupWidgetFlag&&l.close(b)},isOpen:function(b){return!(!b||!b.__popupWidgetOpenFlag)},toggle:function(b){k.isOpen(b)?k.close(b):k.open(b)},refresh:function(b){if(b){b=b.__popupInfo;var d=r.isBodyLtr();b&&t.around(b.wrapper,b.around,b.orient,d)}},getWrapper:function(b){return b&&b._popupWrapper}};return k});