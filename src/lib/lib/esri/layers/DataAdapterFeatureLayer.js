// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/layers/DataAdapterFeatureLayer","../declare dojo/_base/lang dojo/_base/array dojo/when ./FeatureLayer ../renderers/SimpleRenderer ../symbols/SimpleFillSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol".split(" "),function(g,d,e,f,h,k,l,m,n){return g("esri.layers.DataAdapterFeatureLayer",h,{locationProvider:null,dataAdapter:null,dataAdapterQuery:null,_preventInit:!0,constructor:function(b,a){this.dataAdapterQuery=a&&a.dataAdapterQuery;this.locationProvider=a&&a.locationProvider;
if((this.dataAdapter=b)&&this.locationProvider&&this.dataAdapterQuery){var c=d.hitch(this,this._init,a);if(this.locationProvider.loaded)this._queryDataAdapter().then(c);else this.locationProvider.on("load",d.hitch(this,function(){this._queryDataAdapter().then(c)}))}},_queryDataAdapter:function(){function b(c,b){return{idField:c.idField,fields:e.filter(c.fields,function(b){return-1!==e.indexOf(a.dataAdapterQuery.outFields,b.name)||b.name===c.idField}),recordSet:b}}var a=this;return f(this.dataAdapter.getTableInfo(this.dataAdapterQuery.tableId)).then(function(c){return f(a.dataAdapter.query(a.dataAdapterQuery)).then(d.partial(b,
c))})},_init:function(b,a){var c;switch(this.locationProvider.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":c=new m;break;case "esriGeometryPolyline":c=new n;break;case "esriGeometryPolygon":c=new l}a={layerDefinition:{geometryType:this.locationProvider.geometryType,objectIdField:a.idField,fields:a.fields,drawingInfo:{renderer:(new k(c)).toJson()}},featureSet:{features:a.recordSet.features}};this.on("load",d.hitch(this,this._locateFeatures));this._initFeatureLayer(a,b)},_locateFeatures:function(){var b=
this,a=this.getMap(),c=function(){b._fireUpdateStart();b.locationProvider.locate(b.graphics,{outSpatialReference:a.spatialReference}).then(function(){b._fireUpdateEnd()})};if(a&&!this._located)if(this._located=!0,this.locationProvider.loaded)c();else this.locationProvider.on("load",c)},_isWebGLCompatible:function(){return!1},_setMap:function(){var b=this.inherited(arguments);this._locateFeatures();return b}})});