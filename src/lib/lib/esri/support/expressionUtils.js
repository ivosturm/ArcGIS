// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/support/expressionUtils","dojo/_base/lang dojo/_base/array dojo/has dojo/Deferred ../kernel ../arcade/arcade ../arcade/Feature".split(" "),function(g,h,n,k,p,d,l){var q={vars:{$feature:"any",$view:"any"}},m=/^\$feature\./i,e={_getSyntaxTree:function(a){return"string"===typeof a?e.createSyntaxTree(a):a},createSyntaxTree:function(a){var b;try{b=a?d.parseScript(a):null}catch(c){b=null}return b},createFunction:function(a,b){b=b||g.clone(q);a=e._getSyntaxTree(a);var c;try{c=a?d.compileScript(a,
b):null}catch(f){console.log("expressionUtils.createFunction: compilation failed. "+(f.message||"")),c=null}return c},createExecContext:function(a,b){return{vars:{$feature:a?l.createFromGraphic(a):new l,$view:b&&b.view},spatialReference:b&&b.sr}},evalSyntaxTree:function(a,b){var c;try{c=d.executeScript(a,b)}catch(f){c=null}return c},executeFunction:function(a,b){var c;try{c=a?a(b):null}catch(f){c=null}return c},executeAsyncFunction:function(a,b){var c;try{c=a?a(b):(new k).reject(Error("expressionUtils.executeAsyncFunction: Invalid argument. compiledFunc is missing."))}catch(f){c=
(new k).reject(f)}return c},extractFieldNames:function(a){a=e._getSyntaxTree(a);a=d.extractFieldLiterals(a);var b=[];h.forEach(a,function(a){m.test(a)&&(a=a.replace(m,""),b.push(a))});b.sort();return h.filter(b,function(a,d){return 0===d||b[d-1]!==a})},dependsOnView:function(a){return e.hasVariable(a,"$view")},hasGeometryOperations:function(a){return(a=e._getSyntaxTree(a))?d.scriptUsesGeometryEngine(a):!1},enableGeometryOperations:function(){return d.enableGeometrySupport()},hasVariable:function(a,
b){return(a=e._getSyntaxTree(a))?d.referencesMember(a,b):!1},hasFunction:function(a,b){return(a=e._getSyntaxTree(a))?d.referencesFunction(a,b):!1},createFeatureSetFromLayer:function(a,b){b=b||{};var c=d.featureSetUtils();return c?c.constructFeatureSet(a,b.spatialReference,b.outFields,b.returnGeometry,b.cache):null},createFeatureSetFromLayerUrl:function(a,b){b=b||{};var c=d.featureSetUtils();return c?c.constructFeatureSetFromUrlRaw(a,b.spatialReference,b.outFields,b.returnGeometry,b.cache):null},createFeatureSetCollectionFromMap:function(a,
b){var c=d.featureSetUtils();return c?c.createFeatureSetCollectionFromMap(a,a.spatialReference,b&&b.cache):null},createFeatureSetCollectionFromServiceUrl:function(a,b){b=b||{};var c=d.featureSetUtils();return c?c.createFeatureSetCollectionFromService(a,b.spatialReference,b.cache):null},hasFeatureSetOperations:function(a){return(a=e._getSyntaxTree(a))?d.scriptUsesFeatureSet(a):!1},enableFeatureSetOperations:function(){return d.enableFeatureSetSupport().then(function(){var a=d.featureSetUtils();a&&
a.initialiseMetaDataCache()})},enableAsyncOperations:function(){return d.enableAsyncSupport()}};n("extend-esri")&&g.setObject("support.expressionUtils",e,p);return e});