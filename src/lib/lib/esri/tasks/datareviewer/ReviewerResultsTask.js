// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.32/esri/copyright.txt for details.
//>>built
define("esri/tasks/datareviewer/ReviewerResultsTask","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/json dojo/has ./_DRSBaseTask ../../request ../FeatureSet ../../layers/FeatureEditResult ../../kernel".split(" "),function(q,l,u,m,r,v,w,n,t,x,y){q=q(w,{declaredClass:"esri.tasks.datareviewer.ReviewerResultsTask",constructor:function(f){this.onGetResultsComplete=l.hitch(this,this.onGetResultsComplete);this.onWriteResultComplete=l.hitch(this,this.onWriteResultComplete);this.onWriteFeatureAsResultComplete=
l.hitch(this,this.onWriteFeatureAsResultComplete);this.onGetLayerDefinitionComplete=l.hitch(this,this.onGetLayerDefinitionComplete);this.onGetBatchRunDetailsComplete=l.hitch(this,this.onGetBatchRunDetailsComplete)},getResults:function(f,k){var g=this._successHandler,e=this._errorHandler,h=this._appendQueryParams,d=this._url+"/ReviewerResults/getResults",d=h(d),b=new m;f={queryParameters:f.toJSON(),f:"json"};null!==k&&void 0!==k&&(f.filtersArray=k.toJSON());n({callbackParamName:"callback",url:d,content:f}).then(l.hitch(this,
function(a,c){if(void 0!==a.error)c=Error(),c.message=a.error.message,c.code=a.error.code,e(c,b);else try{if(void 0===a.features||void 0===a.fieldAliases||void 0===a.fields)e(null,b);else{var d=new t(a);g({featureSet:d},"onGetResultsComplete",b)}}catch(z){e(z,b)}}),function(a,c){e(a,b)});return b},writeResult:function(f,k){var g=this._successHandler,e=this._errorHandler,h=this._appendQueryParams,d=this._url+"/ReviewerResults/writeResult",d=h(d),b=new m;n({callbackParamName:"callback",url:d,content:{reviewerAttributes:f.toJSON(),
geometry:r.stringify(k.toJson()),f:"json"}}).then(l.hitch(this,function(a,c){c=Error();if(void 0!==a.error)c.message=a.error.message,c.code=a.error.code,e(c,b);else try{void 0!==a.result&&"error"===a.result?(c.message=a.messages,c.code=a.result,e(c,b)):"success"===a.result?g({success:!0},"onWriteResultComplete",b):e(null,b)}catch(p){e(p,b)}}),function(a,c){e(a,b)});return b},writeFeatureAsResult:function(f,k){var g=this._successHandler,e=this._errorHandler,h=this._appendQueryParams,d=this._url+"/ReviewerResults/writeFeatureAsResult",
d=h(d),b=new m;n({callbackParamName:"callback",url:d,content:{reviewerAttributes:f.toJSON(),feature:r.stringify(k.toJson()),f:"json"}}).then(l.hitch(this,function(a,c){c=Error();if(void 0!==a.error)c.message=a.error.message,c.code=a.error.code,e(c,b);else try{void 0!==a.result&&"error"===a.result?(c.message=a.messages,c.code=a.result,e(c,b)):"success"===a.result?g({success:!0},"onWriteFeatureAsResultComplete",b):e(null,b)}catch(p){e(p,b)}}),function(a,c){e(a,b)});return b},getLayerDefinition:function(f){var k=
this._successHandler,g=this._errorHandler,e=this._appendQueryParams,h=this._url+"/ReviewerResults/getLayerDefinition",h=e(h),d=new m,e={f:"json"};if(null!==f||void 0!==f)e.filtersArray=f.toJSON();n({callbackParamName:"callback",url:h,content:e}).then(l.hitch(this,function(b,a){if(void 0!==b.error)a=Error(),a.message=b.error.message,a.code=b.error.code,g(a,d);else try{void 0===b.whereClause?g(null,d):k({whereClause:b.whereClause},"onGetLayerDefinitionComplete",d)}catch(c){g(c,d)}}),function(b,a){g(b,
d)});return d},getBatchRunDetails:function(f){var k=this._successHandler,g=this._errorHandler,e=this._appendQueryParams,h=this._url+"/ReviewerResults/getBatchRunDetails",h=e(h),d=new m;n({callbackParamName:"callback",url:h,content:{batchRunIds:r.stringify(f),f:"json"}}).then(l.hitch(this,function(b,a){if(void 0!==b.error)a=Error(),a.message=b.error.message,a.code=b.error.code,g(a,d);else try{if(void 0===b.features||void 0===b.fieldAliases||void 0===b.fields)g(null,d);else{var c=new t(b);k({featureSet:c},
"onGetBatchRunDetailsComplete",d)}}catch(p){g(p,d)}}),function(b,a){g(b,d)});return d},updateLifecycleStatus:function(f,k,g,e){var h=this._successHandler,d=this._errorHandler,b=this._appendQueryParams,a=this._url+"/ReviewerResults/updateLifecycleStatus",a=b(a),c=new m;n({callbackParamName:"callback",url:a,content:{sessionId:f,lifecycleStatus:k,technicianName:g,filtersArray:e.toJSON(),f:"json"}}).then(l.hitch(this,function(a,b){if(void 0!==a.error)b=Error(),b.message=a.error.message,b.code=a.error.code,
d(b,c);else try{var e=[];u.forEach(a.updateResults,function(a){var b=new x;b.error=Error(a.description);b.success=a.success;b.objectId=a.objectId;e.push(b)});h({featureEditResults:e},"onUpdateLifecycleStatusComplete",c)}catch(A){d(A,c)}}),function(a,b){d(a,c)});return c},getResultsFieldNames:function(){return"recordId objectId subtype category sessionId checktitle resourceName checkName notes severity reviewStatus correctionStatus verificationStatus reviewTechnician correctionTechnician verificationTechnician reviewDateUtc correctionDateUtc verificationDateUtc lifecycleStatus".split(" ")},
onGetResultsComplete:function(f){},onWriteResultComplete:function(f){},onWriteFeatureAsResultComplete:function(f){},onGetLayerDefinitionComplete:function(f){},onGetBatchRunDetailsComplete:function(f){},onUpdateLifecycleStatusComplete:function(f){}});v("extend-esri")&&l.setObject("tasks.datareviewer.ReviewerResultsTask",q,y);return q});