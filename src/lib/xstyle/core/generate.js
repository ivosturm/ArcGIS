//>>built
define("xstyle/core/generate",["xstyle/core/elemental","put-selector/put","xstyle/core/utils","xstyle/core/expression","xstyle/core/base"],function(z,w,A,J,K){function m(a,e){a=a.sort?a:[a];return function(c,k,b){var f=c,B;"content"in c||(c.content=void 0);if(void 0===b){var g=(c._contentNode||c).childNodes||0,h=g[0];if(h){var u=t.createDocumentFragment();do u.appendChild(h);while(h=g[0]);c.content=u}if(c._contentNode){c._contentNode=void 0;try{c.innerHTML=""}catch(p){}}}for(var D=0,E=[c],C=[],g=
0,h=a.length;g<h;g++){var F=d,d=a[g];try{if(d.eachProperty){if(d.args)if("("==d.operator){var q=a[g+1];G(d,q,f,function(a,b,c){L(a,b,c,e)})}else{var n=d.args[0];if("string"===typeof n){var r=n.split("\x3d");try{f.setAttribute(r[0],r[1])}catch(p){console.error(p)}}else{var m=n[0].replace(/=$/,""),x=n[1];"("==x.operator?G(n[1],m,f,function(a,b,c){M(a,b,c,e)}):f.setAttribute(m,x.value)}}}else if("string"==typeof d){"\x3d"==d.charAt(0)&&(d=d.slice(1));var l=f,q=a[g+1],r=[];d.replace(/([,\n]+)?([\t ]*)?(\.|#)?([-\w%$|\.\#]+)(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,
function(){r.push(arguments)});for(var y=0;y<r.length;y++)(function(a,g,h,d,m,u,t){function p(){var a=l._contentNode;a&&(a.innerHTML="",l=a)}g?(a=h?h.length:0,a>D?(p(),E[a]=l):l=E[a]||l,D=a):p();var n;if(d)n=(F&&F.args?"":"span")+d+m;else{d=m.match(/^[-\w]+/);if(!d)throw new SyntaxError("Unable to parse selector",m);d=d[0];var v;y===r.length-1&&q&&q.selector?(q.bases||A.extend(q,d),v=q):v=e.getDefinition(d);v&&(v.then||v.newElement)?l=function(a,b,c,e){var d,f;A.when(v&&v.newElement&&v.newElement(),
function(a){(d=a)?(c=c.slice(e.length))&&w(d,c):d=w(c);if(f){f.parentNode.replaceChild(d,f);a=f.childNodes;var b;for(d=d._contentNode||d;b=a[0];)d.appendChild(b)}});if(d)return a.insertBefore(d,b||null);f=w("span");return a.insertBefore(f,b||null)}(l,b,m,d):n=m}n&&(l=w(b||l,(b?"-":"")+n));b=null;u&&l.setAttribute(u,""===t?u:t);k&&(l.item=k);B=B||l;(y<r.length-1||l!=f&&l!=c)&&C.push(y==r.length-1&&q&&q.selector,l);f=l}).apply(this,r[y])}else f.appendChild(t.createTextNode(d.value))}catch(p){console.error(p,
p.stack),f.innerHTML&&(f.innerHTML=""),f.appendChild(t.createTextNode(p))}}for(;d=C.pop();)z.update(d,C.pop());return B}}function G(a,e,c,k){var b,f;e&&e.eachProperty?(w(c,b=e.selector),f=e):(w(c,b=a.selector||(a.selector=".-xbind-"+N++)),f=a);var m=a.getArgs()[0],g=a.expressionResult,h=a.expressionDefinition;h||(h=a.expressionDefinition=J.evaluate(a.parent,m),g=h.valueOf(),z.addInputConnector(f,h),function(b,c,e){a.expressionResult=g;e.dependencyOf&&e.dependencyOf({invalidate:function(a){a=a?z.matchesRule(a.elements[0],
f)?a.elements:a.elements[0].querySelectorAll(c):document.querySelectorAll(c);for(var g=0,d=a.length;g<d;g++)k(a[g],b,e.valueOf())}})}(e,b,h));k(c,e,g)}function x(a,e,c,k){return A.when(a,function(a){a&&a.forRule&&(a=a.forRule(e));a&&a.forElement&&(a=a.forElement(c));k(a)})}function M(a,e,c,k){x(c,k,a,function(b){a.setAttribute(e,b)})}function L(a,e,c,k){a._defaultBinding=!0;if(c&&c.then&&"INPUT"!==a.tagName)try{a.appendChild(t.createTextNode("Loading"))}catch(b){}x(c,k,a,function(b){if(a._defaultBinding)if(H(a),
a.childNodes.length&&(a.innerHTML=""),b&&b.sort)if(b.isSequence)m(b,k)(a);else{var c=e&&e.definitions&&e.definitions.each,x=k.newRule(),c=c?m(c,x):function(a,b,c){return w(c||a,(c?"-":"")+(O[a.tagName]||"span"),""+b)},g=[],h;b.track&&(b=b.track(),h=b.tracking);b.forEach(function(b){g.push(c(a,b,null))});if(b.on)var u=b.on("add,delete,update",function(b){var e=b.target,f=b.previousIndex;b=b.index;if(-1<f){var h=g[f];H(h,!0);h.parentNode.removeChild(h);g.splice(f,1)}-1<b&&g.splice(b,0,c(a,e,g[b]||null))});
if(h=h||u)a.xcleanup=function(){h.remove()}}else b&&b.nodeType?a.appendChild(b):(b=void 0===b?"":b,a.tagName in P?"checkbox"===a.type?a.checked=b:a.value=b:a.appendChild(t.createTextNode(b)))})}function H(a,e){a.xcleanup&&a.xcleanup(e);a=a.getElementsByTagName("*");e=0;for(var c=a.length;e<c;e++){var k=a[e];k.xcleanup&&k.xcleanup(!0)}}function I(a,e){return m(e,K)(a)}var O={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},P={INPUT:1,TEXTAREA:1,SELECT:1},t=document,N=1;I.forSelector=
m;return I});